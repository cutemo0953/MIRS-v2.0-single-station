# MIRS Satellite PWA 測試指南

> 給醫師、護理師、藥師、醫療志工的手機 App 測試說明

---

## 什麼是 MIRS Satellite PWA？

**MIRS Satellite PWA** 是一個手機網頁應用程式，讓醫護人員可以：
- 在病床旁記錄生命徵象
- 在藥庫掃描藥品確認發藥
- 在設備間巡檢設備狀態
- 即使網路不穩，操作也會暫存，恢復後自動同步

**就像行動護理站** - 您在床邊記錄，資料會自動回傳到護理站電腦。

---

## 測試前準備

### 需要的設備
- [ ] 一台電腦（運行 MIRS Hub）
- [ ] 一支智慧型手機（Android 或 iPhone）
- [ ] 電腦和手機連接同一個 WiFi 網路

### ⚠️ 重要：首次配對網路要求

**首次配對時，電腦（Hub）和手機必須連接到同一個 WiFi 網路。**

這是因為：
1. 手機掃描 QR Code 後，會連接到電腦的 IP 位址（如 `192.168.1.100`）
2. 如果手機和電腦不在同一個區域網路，將無法連接
3. 配對成功後取得的 Token 有效期為 12 小時

**常見問題**：
- 確認手機沒有使用行動數據（4G/5G）
- 某些公共 WiFi 會隔離設備，建議使用私人 WiFi
- 確認電腦防火牆允許相應 port（預設 8000）的連線

### 確認 Hub 已啟動
1. 電腦上開啟瀏覽器
2. 前往 `http://localhost:8000`（MIRS 預設 port）
3. 看到 MIRS 管理介面 = Hub 已啟動 ✓

---

## 測試流程 A：配對連線

### 步驟 1：管理員產生配對 QR Code

1. 在電腦上登入 MIRS 管理介面

2. 前往「**設定**」→「**Satellite 配對**」

3. 點擊「**產生 QR Code**」
   - ⚠️ 此 QR Code **5 分鐘後過期**
   - 過期後需要重新產生

### 步驟 2：手機掃描 QR Code

1. 打開手機的**相機** App

2. 掃描電腦上的 QR Code

3. 手機會開啟瀏覽器，自動連線

4. 看到「**連線成功**」= 配對完成 ✓

### 預期結果
- [ ] 手機顯示 MIRS Satellite 主畫面
- [ ] 顯示醫療站名稱
- [ ] 可以看到目前的傷患統計

---

## 測試流程 B：檢傷分類更新

### 場景
護理師在檢傷區使用手機更新傷患狀態

### 步驟

1. 在 Satellite PWA，點擊「**檢傷分類**」

2. 掃描或輸入傷患編號（如 `PT0001`）

3. 選擇新的檢傷狀態：
   - 🟢 **GREEN** - 輕傷，可延後
   - 🟡 **YELLOW** - 中傷，需優先
   - 🔴 **RED** - 重傷，立即處理
   - ⚫ **BLACK** - 無法救治

4. 輸入備註（選填）

5. 點擊「**確認更新**」

### 預期結果
- [ ] 手機顯示更新成功
- [ ] 電腦上傷患狀態已更新
- [ ] 事件記錄中有檢傷紀錄

---

## 測試流程 C：設備巡檢

### 場景
技術人員巡檢發電機、氧氣系統等設備

### 步驟

1. 在 Satellite PWA，點擊「**設備巡檢**」

2. 掃描設備上的 QR Code（或手動選擇）

3. 記錄巡檢結果：
   - ✅ **正常運作**
   - ⚠️ **需要維修**
   - ❌ **停止運作**

4. 輸入檢查備註（如「油量剩餘 50%」）

5. 點擊「**完成巡檢**」

### 預期結果
- [ ] 手機顯示巡檢完成
- [ ] 電腦上設備狀態已更新
- [ ] 最後檢查日期已更新

---

## 測試流程 D：藥品發放

### 場景
藥師在藥庫確認發藥

### 步驟

1. 在 Satellite PWA，點擊「**藥品發放**」

2. 掃描藥品條碼或輸入藥品代碼

3. 輸入發放數量

4. 選擇領藥對象（傷患編號）

5. 點擊「**確認發放**」

### 預期結果
- [ ] 手機顯示發放成功
- [ ] 藥品庫存已減少
- [ ] 傷患用藥紀錄已更新

---

## 測試流程 E：生命徵象記錄

### 場景
護理師在病床旁記錄 Vital Signs

### 步驟

1. 在 Satellite PWA，點擊「**生命徵象**」

2. 選擇或掃描傷患編號

3. 輸入測量數據：
   - **血壓** (BP): 如 120/80 mmHg
   - **心率** (HR): 如 72 bpm
   - **血氧** (SpO2): 如 98%
   - **體溫** (Temp): 如 36.5°C

4. 點擊「**儲存記錄**」

### 預期結果
- [ ] 手機顯示記錄成功
- [ ] 電腦上可看到新的生命徵象紀錄
- [ ] 數據圖表已更新

---

## 測試流程 F：離線操作（重要！）

### 為什麼要測試離線？
醫療環境可能有電磁干擾或網路死角，必須確保離線時操作不會遺失。

### 步驟

1. **關閉手機 WiFi**（模擬進入電磁屏蔽區域）

2. 執行以下操作：
   - 更新一位傷患的檢傷狀態
   - 記錄一組生命徵象

3. 確認畫面顯示「**Pending: 2**」

4. **重新開啟 WiFi**

5. 等待自動同步，或點擊「**Sync Now**」

6. 在電腦上確認所有記錄正確

### 預期結果
- [ ] 離線時可以操作
- [ ] Pending 計數正確
- [ ] 同步後資料完整
- [ ] 沒有重複記錄

---

## 測試流程 G：血庫查詢

### 場景
檢驗師查詢血液庫存

### 步驟

1. 在 Satellite PWA，點擊「**血庫查詢**」

2. 查看各血型庫存：
   - A+, A-, B+, B-, O+, O-, AB+, AB-

3. 確認顯示與電腦上一致

### 預期結果
- [ ] 可以查看所有血型庫存
- [ ] 數據與主系統一致
- [ ] 過期血品有標示

---

## 醫療專用注意事項

### 資料安全
- 🔒 所有傳輸皆經過加密
- 🔒 Token 有效期 12 小時，之後需重新配對
- 🔒 手機不儲存病患個資，僅暫存操作指令

### 離線優先設計
- 操作先存手機，再同步到主機
- 網路恢復後自動同步
- 重複提交會自動去重（不會重複記錄）

### 建議工作流程
1. 每班開始時掃描配對 QR Code
2. 執行完操作後確認「已同步」
3. 如果看到「Pending」，請在有網路時同步
4. 下班前確認所有 Pending = 0

---

## iOS 特別注意

iPhone 用戶請注意：

1. Safari 不支援背景自動同步
2. 離線操作後，需要**手動點擊「Sync Now」**
3. 請注意 Navbar 上的「**Pending: N**」數字
4. 確保同步完成後再關閉瀏覽器

---

## 常見問題

### Q: 配對後多久會過期？
- 配對 QR Code：5 分鐘
- 配對後的 Token：12 小時
- 建議每班重新配對一次

### Q: 離線操作會遺失嗎？
- 不會！操作會暫存在手機
- 恢復網路後自動（或手動）同步
- 即使重複提交也不會重複記錄

### Q: 多台手機可以同時使用嗎？
- 可以！每台手機獨立配對
- 系統會記錄是哪台設備執行的操作

### Q: 手機沒電了怎麼辦？
- 未同步的操作會遺失
- 建議：操作後立即確認「已同步」
- 建議：手機電量低於 20% 時先同步

---

## 測試檢查清單

### 連線功能
- [ ] QR Code 配對成功
- [ ] 可以看到醫療站狀態
- [ ] Token 12 小時內有效

### 醫療功能
- [ ] 檢傷分類更新正常
- [ ] 生命徵象記錄正常
- [ ] 藥品發放正常
- [ ] 設備巡檢正常
- [ ] 血庫查詢正常

### 離線功能
- [ ] 離線時可操作
- [ ] Pending 計數正確
- [ ] 同步後資料完整
- [ ] 無重複記錄

### iOS 特別
- [ ] Pending 指示器正常
- [ ] Sync Now 按鈕可用
- [ ] 手動同步正常

---

## 問題回報

發現問題請記錄：

1. **問題描述**
2. **操作步驟**
3. **手機型號與系統版本**
4. **瀏覽器**
5. **截圖**

回報至：[GitHub Issues](https://github.com/anthropics/mirs/issues)

---

*文件版本：v1.1*
*最後更新：2025-12*
*適用：MIRS v1.4.7+*
