# EMT Transfer Handoff é–‹ç™¼è¦æ ¼æ›¸ (MIRS ç«¯)

**ç‰ˆæœ¬**: 3.3
**æ—¥æœŸ**: 2026-01-06
**ç‹€æ…‹**: Draft
**ä¾è³´**:
- DEV_SPEC_EMT_TRANSFER_PWA.md v2.2.4
- **CIRS: xIRS_UNIFIED_HANDOFF_SPEC_v1.4.md** â† çµ±ä¸€äº¤ç­æ¶æ§‹

---

## ç‰ˆæœ¬æ­·å²

| ç‰ˆæœ¬ | æ—¥æœŸ | è®Šæ›´ |
|------|------|------|
| 3.0 | 2026-01-05 | é‡æ§‹ç‚º CIRS çµ±ä¸€äº¤ç­æ¶ˆè²»ç«¯ |
| 3.1 | 2026-01-05 | æ–°å¢æ‰‹å‹•å»ºç«‹äº¤ç­å–® (å¤–ç«™è½‰å…¥)ã€GCS E/V/M æ ¼å¼ã€ISBAR/MIST é¸æ“‡ |
| 3.2 | 2026-01-05 | å…§éƒ¨è½‰é€ä¹Ÿå¯å¡« ISBAR/MISTã€ç«™é»åç¨±é¡¯ç¤ºã€source_station/local_station |
| **3.3** | **2026-01-06** | **äº¤ç­å ±å‘Š Modal + é€”ä¸­äº‹ä»¶è¨˜éŒ„ + CIRS complete é€šçŸ¥** |

---

## 0. æ‘˜è¦

æœ¬è¦æ ¼æ›¸æè¿° **MIRS EMT PWA å¦‚ä½•æ¶ˆè²» CIRS çµ±ä¸€äº¤ç­ç³»çµ±**ã€‚

> **é‡è¦æ¶æ§‹è®Šæ›´ (v3.0)**:
> - äº¤ç­è³‡æ–™çµ±ä¸€ç”± CIRS `handoff_records` ç®¡ç†
> - EMT PWA å¾ CIRS è®€å–äº¤ç­ï¼ˆ90% åªè®€ + 10% è£œå……ï¼‰
> - ä¸å†æ–¼ EMT ç«¯é‡è¤‡å»ºç«‹äº¤ç­è¡¨å–®

### ä½¿ç”¨æƒ…å¢ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CIRS Doctor     â”‚                        â”‚  MIRS EMT PWA    â”‚
â”‚  (é†«å¸«ç«™)         â”‚                        â”‚  (è½‰é€æ¨¡çµ„)       â”‚
â”‚                  â”‚                        â”‚                  â”‚
â”‚  å‹¾é¸ã€Œéœ€è½‰é€ã€   â”‚                        â”‚                  â”‚
â”‚       â†“          â”‚                        â”‚                  â”‚
â”‚  è‡ªå‹•å»ºç«‹        â”‚      handoff           â”‚                  â”‚
â”‚  handoff_record  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚  è®€å–å¾…æ¥æ”¶      â”‚
â”‚  (PENDING)       â”‚                        â”‚       â†“          â”‚
â”‚                  â”‚                        â”‚  é»æ“Šã€Œæ¥æ”¶ã€     â”‚
â”‚                  â”‚   â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚       â†“          â”‚
â”‚  status=ACCEPTED â”‚      POST /accept      â”‚  è‡ªå‹•å¡«å…¥ä»»å‹™     â”‚
â”‚                  â”‚                        â”‚  (90% åªè®€)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è¨­è¨ˆåŸå‰‡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  äº¤ç­ = è³‡æ–™ç´¯ç©çš„å¿«ç…§ (ç”± CIRS ç”¢ç”Ÿ)                                         â”‚
â”‚                                                                              â”‚
â”‚  EMT PWA è·è²¬ï¼š                                                              â”‚
â”‚  1. è®€å– CIRS äº¤ç­ (handoff_records)                                         â”‚
â”‚  2. æ¥æ”¶ç¢ºèª (POST /accept)                                                  â”‚
â”‚  3. åŸ·è¡Œç‰©æµä»»å‹™ (ç‰©è³‡æ•´å‚™ã€è½‰é€ã€çµæ¡ˆ)                                        â”‚
â”‚  4. è£œå……é€”ä¸­äº‹ä»¶ (append-only addenda)                                        â”‚
â”‚                                                                              â”‚
â”‚  åŸå‰‡ï¼š90% è‡ªå‹•å¸¶å…¥ (Read-only) + 10% é€”ä¸­è£œå…… (Write)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒéœ€æ±‚

| éœ€æ±‚ | èªªæ˜ | ç‹€æ…‹ |
|------|------|------|
| **O2 æµé‡é è¨­å€¼** | ç„¡/3/6/10/15 L/min å¿«é¸æŒ‰éˆ• | âœ“ å·²å¯¦ä½œ (v1.1.0) |
| **è®€å– CIRS äº¤ç­** | å¾ handoff_records è‡ªå‹•å¸¶å…¥ | æœ¬ç‰ˆæ–°å¢ |
| **ç‰©è³‡æ•´å‚™** | RESERVE/ISSUE/RETURN æ­£è¦åŒ– | æœ¬ç‰ˆå¼·åŒ– |
| **PSI è¿½è¹¤** | æ°§æ°£ç“¶ PSI è¨˜éŒ„ï¼ˆåŒéº»é†‰æ¨¡çµ„ï¼‰ | æœ¬ç‰ˆæ–°å¢ |

---

## 1. Step æµç¨‹é‡è¨­è¨ˆ (v3.0)

### 1.1 æ–°ç‰ˆ Step æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 0           â”‚  Step 1        â”‚  Step 2      â”‚  Step 3      â”‚         â”‚
â”‚  æ¥æ”¶äº¤ç­         â”‚  ç‰©è³‡æ•´å‚™      â”‚  è½‰é€ä¸­      â”‚  çµæ¡ˆ        â”‚         â”‚
â”‚  (PLANNING)       â”‚  (READY)       â”‚  (EN_ROUTE)  â”‚  (COMPLETED) â”‚         â”‚
â”‚                   â”‚                â”‚              â”‚              â”‚         â”‚
â”‚  è®€å– CIRS äº¤ç­   â”‚  æ°§æ°£é‹¼ç“¶      â”‚  å³æ™‚è¿½è¹¤    â”‚  æ¶ˆè€—çµ±è¨ˆ    â”‚         â”‚
â”‚  ç¢ºèªç—…æ‚£è³‡è¨Š     â”‚  è¨­å‚™é›»é‡      â”‚  é€”ä¸­äº‹ä»¶    â”‚  æ­¸é‚„ç‰©è³‡    â”‚         â”‚
â”‚  (90% åªè®€)       â”‚  è—¥ç‰©/è€—æ     â”‚              â”‚              â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 Step è®Šæ›´å°ç…§

| ç‰ˆæœ¬ | Step 0 | Step 1 | Step 2 | Step 3 |
|------|--------|--------|--------|--------|
| v1.x | æ‰‹å‹•ä»»å‹™è¨­å®š | ç‰©è³‡ç¢ºèª | è½‰é€ä¸­ | çµæ¡ˆ |
| v2.0 | ä»»å‹™è¨­å®š | äº¤ç­è¼¸å…¥ (æ‰‹å‹•) | ç‰©è³‡æ•´å‚™ | çµæ¡ˆ |
| **v3.0** | **æ¥æ”¶ CIRS äº¤ç­ (åªè®€)** | **ç‰©è³‡æ•´å‚™** | **è½‰é€ä¸­** | **çµæ¡ˆ** |

### 1.3 é—œéµè®Šæ›´

1. **ç§»é™¤æ‰‹å‹•äº¤ç­è¼¸å…¥**: Step 0 ä¸å†éœ€è¦ EMT æ‰‹å‹•å¡«å¯« ISBAR/MIST
2. **è‡ªå‹•å¸¶å…¥**: å¾ CIRS `handoff_records.snapshot` è®€å–å®Œæ•´è³‡æ–™
3. **EMT åªéœ€è£œå……**: é€”ä¸­äº‹ä»¶ã€å¯¦éš›æ¶ˆè€—ã€å‚™è¨»

---

## 2. Step 0: æ¥æ”¶ CIRS äº¤ç­ (åªè®€)

### 2.1 å¾…æ¥æ”¶äº¤ç­åˆ—è¡¨

EMT PWA å•Ÿå‹•å¾Œï¼Œå¾ CIRS å–å¾— `target_role=EMT` çš„å¾…è™•ç†äº¤ç­ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¾…æ¥æ”¶äº¤ç­                                    [é‡æ–°æ•´ç†]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ğŸ”´ URGENT                          10:32 å»ºç«‹           â”‚ â”‚
â”‚ â”‚ ç‹å¤§æ˜ 45M  å³è‚¡éª¨é–‹æ”¾æ€§éª¨æŠ˜ ORIF                       â”‚ â”‚
â”‚ â”‚ ç›®çš„åœ°: å¾Œé€é†«é™¢ A                                      â”‚ â”‚
â”‚ â”‚ O2: 6 L/min    æ ¼å¼: MIST                              â”‚ â”‚
â”‚ â”‚                                        [æ¥æ”¶æ­¤äº¤ç­]    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ â—‹ NORMAL                           09:45 å»ºç«‹           â”‚ â”‚
â”‚ â”‚ é™³å¿—æ˜ 62M  TKA è¡“å¾Œ                                    â”‚ â”‚
â”‚ â”‚ ç›®çš„åœ°: å¾Œé€é†«é™¢ B                                      â”‚ â”‚
â”‚ â”‚ O2: ç„¡        æ ¼å¼: ISBAR                              â”‚ â”‚
â”‚ â”‚                                        [æ¥æ”¶æ­¤äº¤ç­]    â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 æ¥æ”¶äº¤ç­æµç¨‹

```javascript
async acceptHandoff(handoffId) {
    // 1. å‘ CIRS ç™¼é€æ¥å—è«‹æ±‚
    const resp = await fetch(`${CIRS_HUB_URL}/api/handoff/${handoffId}/accept`, {
        method: 'POST',
        headers: { 'Authorization': `Bearer ${this.token}` }
    });

    // 2. ç²å–äº¤ç­è©³æƒ… (å« snapshot)
    const handoff = await resp.json();

    // 3. æœ¬åœ°å»ºç«‹ transfer_mission
    this.currentMission = {
        mission_id: `TM-${Date.now()}`,
        cirs_handoff_id: handoff.handoff_id,
        patient_snapshot: handoff.snapshot,  // é–å®šç‰ˆæœ¬
        vital_signs_snapshot: handoff.vital_signs_snapshot,
        content: handoff.content,  // ISBAR/MIST å…§å®¹
        format: handoff.format,
        status: 'PLANNING'
    };

    // 4. é€²å…¥ Step 1 (ç‰©è³‡æ•´å‚™)
    this.goToStep(1);
}

async rejectHandoff(handoffId, reason, code) {
    // v1.1: æ‹’çµ•äº¤ç­
    await fetch(`${CIRS_HUB_URL}/api/handoff/${handoffId}/reject`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${this.token}`
        },
        body: JSON.stringify({
            rejector_id: this.emtId,
            rejector_name: this.emtName,
            rejection_code: code,  // PATIENT_UNSTABLE | NO_CAPACITY | OTHER
            rejection_reason: reason
        })
    });
    // é‡æ–°è¼‰å…¥å¾…æ¥æ”¶åˆ—è¡¨
    await this.loadPendingHandoffs();
}
```

### 2.4 æŠµé”é‡æ¸¬ Vital Signs (v1.1 æ–°å¢)

EMT æŠµé”ç—…æ‚£è™•æ™‚ï¼Œæ‡‰é‡æ¸¬ Vital Signs ä¸¦è¨˜éŒ„ç‚º addendumï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æŠµé”ç¢ºèª                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç—…æ‚£: ç‹å¤§æ˜ 45M                                            â”‚
â”‚ äº¤ç­ VS (10:30): BP 150/90, HR 88, SpO2 96%                â”‚
â”‚                                                             â”‚
â”‚ âš  å»ºè­°é‡æ¸¬ç”Ÿå‘½å¾µè±¡ (ä¿è­· EMT è²¬ä»»)                          â”‚
â”‚                                                             â”‚
â”‚ ã€æŠµé”æ™‚é‡æ¸¬ã€‘                                               â”‚
â”‚ BP: [145/85]  HR: [92]  SpO2: [97]  GCS: [E4V5M6]          â”‚
â”‚                                                             â”‚
â”‚ å‚™è¨»: [ç—…æ‚£æ„è­˜æ¸…é†’ï¼Œé¡˜æ„é…åˆè½‰é€________________]          â”‚
â”‚                                                             â”‚
â”‚ [ ] è·³éé‡æ¸¬ (ä¸å»ºè­°)                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                             â”‚
â”‚  [æ‹’çµ•æ­¤äº¤ç­]                        [ç¢ºèªæ¥æ”¶ï¼Œé€²å…¥ç‰©è³‡]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```javascript
async recordArrivalVitals(vitals, note) {
    // 1. è¨˜éŒ„åˆ° CIRS handoff_addenda
    await fetch(`${CIRS_HUB_URL}/api/handoff/${this.currentMission.cirs_handoff_id}/addendum`, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${this.token}`
        },
        body: JSON.stringify({
            addendum_type: 'ARRIVAL_VITALS',
            source: 'EMT',
            recorded_by: this.emtId,
            content: {
                note: note,
                vital_signs: vitals
            }
        })
    });

    // 2. æœ¬åœ°ä¹Ÿè¨˜éŒ„ä¸€ä»½ (é›¢ç·šç”¨)
    await this.appendMissionEvent({
        event_type: 'ARRIVAL_VITALS',
        data: { vitals, note },
        timestamp: new Date().toISOString()
    });
}
```

> **æ³•å¾‹ä¿è­·**: æŠµé”é‡æ¸¬çš„ VS è¨˜éŒ„åœ¨ `handoff_addenda`ï¼Œè­‰æ˜ EMT æ¥æ‰‹æ™‚çš„çœŸå¯¦ç‹€æ…‹ã€‚
> èˆ‡åŸ snapshot å°æ¯”å¯é¡¯ç¤ºæ™‚é–“å·®å…§çš„ç—…æƒ…è®ŠåŒ–ã€‚

### 2.5 æ‰‹å‹•å»ºç«‹äº¤ç­å–® (v3.1 æ–°å¢)

é©ç”¨æƒ…å¢ƒï¼š
- å¤–ç«™è½‰é€éä¾†çš„ç—…æ‚£ï¼ˆä¸åœ¨ CIRS ç³»çµ±ä¸­ï¼‰
- è‡ªè¡Œå‰ä¾†çš„å‰µå‚·ç—…æ‚£éœ€ç«‹å³è½‰é€
- ç¾å ´æ€¥æ•‘å¾Œéœ€è¦å¾Œé€

#### 2.5.1 UI è¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ–°å¢è½‰é€ä»»å‹™                                   [CIRS | æ‰‹å‹•] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  ã€å ±å‘Šæ ¼å¼ã€‘                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚ ğŸ“‹ ISBAR      â”‚  â”‚ ğŸš‘ MIST        â”‚                     â”‚
â”‚  â”‚ ä¸€èˆ¬/å…§ç§‘     â”‚  â”‚ å¤–å‚·/å‰µå‚·      â”‚                     â”‚
â”‚  â”‚      â—        â”‚  â”‚                â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç—…æ‚£åŸºæœ¬è³‡æ–™ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚                                                              â”‚
â”‚  å§“å: [________]   å¹´é½¡: [__]   æ€§åˆ¥: â—‹ç”· â—å¥³             â”‚
â”‚  èº«é«˜(cm): [___]    é«”é‡(kg): [___]                         â”‚
â”‚  éæ•: [________________________]                            â”‚
â”‚                                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ç”Ÿå‘½å¾µè±¡ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                           â”‚
â”‚                                                              â”‚
â”‚  BP: [___/___]  HR: [___]  SpO2: [___%]  Temp: [__._]      â”‚
â”‚                                                              â”‚
â”‚  GCS:  E [1-4]  V [1-5]  M [1-6]  = 15                      â”‚
â”‚        [  4 ]   [  5 ]   [  6 ]                              â”‚
â”‚                                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ISBAR å…§å®¹ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚
â”‚                                                              â”‚
â”‚  S - ç¾æ³èªªæ˜:                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  B - ç—…å²èƒŒæ™¯:                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  A - è©•ä¼°:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  R - å»ºè­°:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è½‰é€è³‡è¨Š â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                           â”‚
â”‚                                                              â”‚
â”‚  ç›®çš„åœ°: [________________________]                          â”‚
â”‚  O2 éœ€æ±‚: [ç„¡] [3] [6] [10] [15] L/min                      â”‚
â”‚  å„ªå…ˆåº: â—‹ NORMAL  â— URGENT                                 â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                              â”‚
â”‚  [å–æ¶ˆ]                               [å»ºç«‹ä¸¦é€²å…¥ç‰©è³‡æ•´å‚™]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 2.5.2 è³‡æ–™çµæ§‹

```javascript
// æ‰‹å‹•äº¤ç­å–® (source_type = 'EXTERNAL')
const manualHandoff = {
    source_type: 'EXTERNAL',  // é CIRS ä¾†æº
    format: 'ISBAR',          // æˆ– 'MIST'

    // ç—…æ‚£è³‡æ–™ (æ‰‹å‹•è¼¸å…¥)
    patient: {
        name: 'å¤–ç«™ç—…æ‚£',
        age: 45,
        gender: 'M',
        height_cm: 170,
        weight_kg: 70,
        allergies: ''
    },

    // ç”Ÿå‘½å¾µè±¡ (GCS æ¡ç”¨ E/V/M æ ¼å¼)
    vital_signs: {
        bp_sys: 120,
        bp_dia: 80,
        hr: 75,
        spo2: 98,
        temp: 36.5,
        gcs_e: 4,
        gcs_v: 5,
        gcs_m: 6
    },

    // ISBAR å…§å®¹
    content: {
        situation: '',
        background: '',
        assessment: '',
        recommendation: ''
    },

    // è½‰é€è³‡è¨Š
    destination: '',
    o2_flow: 0,
    priority: 'NORMAL'
};
```

#### 2.5.3 API

```http
POST /api/transfer/handoff/manual
Content-Type: application/json

{
    "source_type": "EXTERNAL",
    "format": "ISBAR",
    "patient": { ... },
    "vital_signs": { ... },
    "content": { ... },
    "destination": "å¾Œé€é†«é™¢ A",
    "o2_flow": 6,
    "priority": "URGENT"
}
```

**å›æ‡‰**:
```json
{
    "handoff_id": "HO-20260105-EXT-001",
    "mission_id": "TM-1736065432000",
    "status": "PLANNING"
}
```

### 2.6 äº¤ç­è©³æƒ…é¡¯ç¤º (åªè®€)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ äº¤ç­è©³æƒ…                                    MIST (å¤–å‚·)     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€ç—…æ‚£è³‡æ–™ã€‘                                                 â”‚
â”‚ å§“å: ç‹å¤§æ˜    å¹´é½¡: 45    æ€§åˆ¥: ç”·                        â”‚
â”‚ èº«é«˜: 175 cm   é«”é‡: 72 kg   BMI: 23.5                     â”‚
â”‚ éæ•: Penicillin                                            â”‚
â”‚                                                             â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚ M - å—å‚·æ©Ÿè½‰                                                â”‚
â”‚     è»Šç¦: æ©Ÿè»Šå°æ’ï¼Œæ™‚é€Ÿç´„ 60 km/h                          â”‚
â”‚                                                             â”‚
â”‚ I - å‚·å‹¢ç™¼ç¾                                                â”‚
â”‚     [â—] å››è‚¢  å³è‚¡éª¨é–‹æ”¾æ€§éª¨æŠ˜ï¼Œç´„ 15cm å‚·å£                â”‚
â”‚                                                             â”‚
â”‚ S - ç”Ÿå‘½å¾µè±¡ (CIRS æœ€æ–°è¨˜éŒ„)                                â”‚
â”‚     BP: 110/70  HR: 100  SpO2: 98%  GCS: E4V5M6            â”‚
â”‚                                                             â”‚
â”‚ T - å·²è™•ç½®                                                  â”‚
â”‚     æ­¢è¡€å¸¶ã€å¤¾æ¿å›ºå®šã€TXA 1gã€IV access                     â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚
â”‚                                                             â”‚
â”‚ ã€è½‰é€è³‡è¨Šã€‘                                                 â”‚
â”‚ ç›®çš„åœ°: å¾Œé€é†«é™¢ A - å‰µå‚·ä¸­å¿ƒ                               â”‚
â”‚ O2: 6 L/min    ETA: 45 min                                 â”‚
â”‚                                                             â”‚
â”‚ å»ºç«‹è€…: æé†«å¸«    å»ºç«‹æ™‚é–“: 2026-01-05 10:32               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                             â”‚
â”‚  [å–æ¶ˆ]                          [ç¢ºèªæ¥æ”¶ï¼Œé€²å…¥ç‰©è³‡æ•´å‚™]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> **é‡è¦**: ä»¥ä¸Šè³‡æ–™çš†ç‚º**åªè®€**ï¼Œä¾†è‡ª CIRS `handoff_records.snapshot`

---

## 3. Step 1: ç‰©è³‡æ•´å‚™

v3.0 æ¶æ§‹ä¸‹ï¼ŒStep 1 å°ˆæ³¨æ–¼**ç‰©è³‡æº–å‚™**ï¼Œäº¤ç­è³‡æ–™å·²åœ¨ Step 0 æ¥æ”¶å®Œæˆã€‚

### 3.1 ç‰©è³‡æ•´å‚™ UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 1/3: ç‰©è³‡æ•´å‚™                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€ç—…æ‚£æ‘˜è¦ã€‘(ä¾†è‡ªäº¤ç­)                                       â”‚
â”‚ ç‹å¤§æ˜ 45M | MIST (å¤–å‚·) | O2: 6 L/min                      â”‚
â”‚ ç›®çš„åœ°: å¾Œé€é†«é™¢ A                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€æ°§æ°£é‹¼ç“¶ã€‘                                                â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ E ç“¶ #E-042                                    [é¸æ“‡]  â”‚ â”‚
â”‚ â”‚ åˆå§‹ PSI: [1800]   å®¹é‡: 682L   é ä¼° 1.9 å°æ™‚           â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚ ã€æ”œå¸¶è¨­å‚™ã€‘                                                â”‚
â”‚ [âœ“] å¿ƒé›»åœ–ç›£æ¸¬å™¨     é›»é‡: 87%                              â”‚
â”‚ [âœ“] æŠ½å¸æ©Ÿ           é›»é‡: 100%                             â”‚
â”‚ [ ] é™¤é¡«å™¨                                                  â”‚
â”‚ [+] æ–°å¢è¨­å‚™...                                             â”‚
â”‚                                                             â”‚
â”‚ ã€æ”œå¸¶è—¥ç‰©/è€—æã€‘                                            â”‚
â”‚ [âœ“] TXA 1g Ã— 2                                             â”‚
â”‚ [âœ“] Morphine 10mg Ã— 1                                      â”‚
â”‚ [âœ“] NS 500mL Ã— 2                                           â”‚
â”‚ [+] æ–°å¢è—¥ç‰©/è€—æ...                                        â”‚
â”‚                                                             â”‚
â”‚ ã€ç‰©è³‡ç™¼æ”¾ã€‘                                 [RESERVE å…¨éƒ¨]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                             â”‚
â”‚  [è¿”å› Step 0]                      [é–‹å§‹è½‰é€ (Step 2)]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 PSI ä¼°ç®— (åŒéº»é†‰æ¨¡çµ„)

```javascript
// é ä¼°å¯ç”¨æ™‚é–“
function estimateO2Duration(psi, flowRate) {
    // E ç“¶: 0.379 L/PSI
    const E_CYLINDER_FACTOR = 0.379;
    const litersAvailable = psi * E_CYLINDER_FACTOR;
    const durationMinutes = litersAvailable / flowRate;
    return {
        liters: litersAvailable.toFixed(0),
        hours: (durationMinutes / 60).toFixed(1),
        safetyMargin: durationMinutes > 120 ? 'SAFE' : durationMinutes > 60 ? 'CAUTION' : 'LOW'
    };
}
```

### 3.3 ç‰©è³‡æ“ä½œ Event Sourcing

```javascript
// RESERVE: é ç•™ç‰©è³‡ (é›¢é–‹å‰)
async reserveResources() {
    for (const item of this.selectedResources) {
        await this.appendMissionEvent({
            event_type: 'RESOURCE_RESERVE',
            resource_type: item.type,  // O2_CYLINDER | EQUIPMENT | MEDICATION
            resource_id: item.id,
            quantity: item.qty,
            initial_value: item.initial_psi || null
        });
    }
}

// ISSUE: å¯¦éš›ç™¼æ”¾ (é–‹å§‹è½‰é€æ™‚)
async issueResources() {
    for (const item of this.reservedResources) {
        await this.appendMissionEvent({
            event_type: 'RESOURCE_ISSUE',
            resource_id: item.id,
            quantity: item.qty
        });
    }
}
```

---

## 4. Step 2: è½‰é€ä¸­

### 4.1 è½‰é€ä¸­ UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2/3: è½‰é€ä¸­                           â± 00:23:45       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€å³æ™‚ç‹€æ…‹ã€‘                                                 â”‚
â”‚ O2 å‰©é¤˜: 1420 PSI (ç´„ 1.4 å°æ™‚)  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘ 79%             â”‚
â”‚                                                             â”‚
â”‚ ç”Ÿå‘½å¾µè±¡æœ€æ–°: 10:55                                          â”‚
â”‚ BP: 115/72  HR: 92  SpO2: 99%  (ç©©å®š)                       â”‚
â”‚                                    [è¨˜éŒ„æ–° Vital Signs]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€é€”ä¸­äº‹ä»¶ã€‘                                                 â”‚
â”‚ 10:35  é–‹å§‹è½‰é€                                              â”‚
â”‚ 10:42  æ›´æ› O2 æµé‡ 6â†’10 L/min (SpO2 ä¸‹é™è‡³ 94%)            â”‚
â”‚ 10:48  çµ¦äºˆ Morphine 5mg IV                                 â”‚
â”‚ 10:55  Vital signs ç©©å®š                                     â”‚
â”‚                                                             â”‚
â”‚                                    [+] è¨˜éŒ„é€”ä¸­äº‹ä»¶          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€å¿«é€Ÿæ“ä½œã€‘                                                 â”‚
â”‚ [O2 èª¿æ•´] [çµ¦è—¥] [Vital Signs] [ç·Šæ€¥äº‹ä»¶]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                             â”‚
â”‚  [ä¸­æ­¢ä»»å‹™]                               [æŠµé”ç›®çš„åœ°]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 é€”ä¸­äº‹ä»¶ (Addenda)

EMT åœ¨è½‰é€é€”ä¸­**åªå¯« addenda**ï¼Œä¸ä¿®æ”¹åŸäº¤ç­å…§å®¹ï¼š

```javascript
async addTransitEvent(eventType, data) {
    await this.appendMissionEvent({
        event_type: 'TRANSIT_EVENT',
        sub_type: eventType,  // VITALS | O2_ADJUST | MEDICATION | EMERGENCY | NOTE
        data: data,
        timestamp: new Date().toISOString(),
        recorded_by: this.currentUser.id
    });

    // åŒæ™‚è¨˜éŒ„åˆ° CIRS (å¦‚æœæœ‰ç¶²è·¯)
    if (navigator.onLine && this.currentMission.cirs_handoff_id) {
        await fetch(`${CIRS_HUB_URL}/api/handoff/${this.currentMission.cirs_handoff_id}/addendum`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${this.token}`
            },
            body: JSON.stringify({
                source: 'EMT',
                event_type: eventType,
                data: data
            })
        });
    }
}
```

### 4.3 O2 æµé‡èª¿æ•´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ èª¿æ•´ O2 æµé‡                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç›®å‰: 6 L/min                                               â”‚
â”‚                                                             â”‚
â”‚ [ç„¡] [3] [6] [10] [15]                                      â”‚
â”‚                  â—                                          â”‚
â”‚                                                             â”‚
â”‚ èª¿æ•´åŸå› :                                                    â”‚
â”‚ â—‹ SpO2 ä¸‹é™     â—‹ ç—…æ‚£ç©©å®š     â—‹ å…¶ä»–: [________]          â”‚
â”‚                                                             â”‚
â”‚ ç›®å‰ SpO2: [94] %                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                               [å–æ¶ˆ]      [ç¢ºèªèª¿æ•´]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 äº¤ç­å ±å‘Š Modal (v3.3 æ–°å¢)

EMT åœ¨è½‰é€é€”ä¸­å¯éš¨æ™‚æŸ¥çœ‹ã€Œäº¤ç­å ±å‘Šã€ï¼Œä¾›å¤–ç«™æ¥æ”¶æ–¹ç¢ºèªç—…æ‚£è³‡è¨Šã€‚

#### 4.4.1 UI è¨­è¨ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ äº¤ç­å ±å‘Š                                               [X]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€ç—…æ‚£åŸºæœ¬è³‡æ–™ã€‘                                            â”‚
â”‚ ç‹å¤§æ˜ 45M                                     â— STABLE    â”‚
â”‚ å³è‚¡éª¨é–‹æ”¾æ€§éª¨æŠ˜ ORIF                                       â”‚
â”‚ ç›®çš„åœ°: å¾Œé€é†«é™¢ A                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€å‡ºç™¼æ™‚äº¤ç­ã€‘                               [MIST]          â”‚
â”‚                                                             â”‚
â”‚ M - å—å‚·æ©Ÿè½‰                                                â”‚
â”‚     æ©Ÿè»Šå°æ’ï¼Œæ™‚é€Ÿç´„ 60 km/h                                â”‚
â”‚                                                             â”‚
â”‚ I - å‚·å‹¢                                                    â”‚
â”‚     å³è‚¡éª¨é–‹æ”¾æ€§éª¨æŠ˜ï¼Œç´„ 15cm å‚·å£                          â”‚
â”‚                                                             â”‚
â”‚ S - å¾µè±¡                                                    â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚     â”‚ BP   â”‚ â”‚ HR   â”‚ â”‚ SpO2 â”‚ â”‚ GCS  â”‚                    â”‚
â”‚     â”‚110/70â”‚ â”‚ 100  â”‚ â”‚ 98%  â”‚ â”‚ 15   â”‚                    â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                             â”‚
â”‚ T - è™•ç½®                                                    â”‚
â”‚     æ­¢è¡€å¸¶ã€å¤¾æ¿å›ºå®šã€TXA 1gã€IV access                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€EMT æ¥æ”¶æ™‚ç”Ÿå‘½å¾µè±¡ã€‘                                      â”‚
â”‚     BP: 108/68  HR: 96  SpO2: 99%  GCS: E4V5M6             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€è½‰é€é€”ä¸­äº‹ä»¶ã€‘                               3 ç­†         â”‚
â”‚                                                             â”‚
â”‚ 10:42  [VS]  BP 115/72, HR 92, SpO2 99%                    â”‚
â”‚ 10:48  [è—¥]  Morphine 5mg IV (ç–¼ç—›ç·©è§£)                     â”‚
â”‚ 10:55  [O2]  O2 èª¿æ•´ç‚º 3 L/min - ç—…æ‚£ç©©å®š                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€è½‰é€æ‘˜è¦ã€‘                                                â”‚
â”‚ è½‰é€æ™‚é–“: 23 åˆ†é˜                                           â”‚
â”‚ O2 æµé‡: 3 L/min                                           â”‚
â”‚ EMT: ç‹å°æ˜                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.4.2 è³‡æ–™ä¾†æº

| å€å¡Š | è³‡æ–™ä¾†æº |
|------|----------|
| ç—…æ‚£åŸºæœ¬è³‡æ–™ | `currentMission.patient_name/age/chief_complaint` |
| å‡ºç™¼æ™‚äº¤ç­ | `currentMission.handoff_snapshot.content` (ISBAR/MIST) |
| EMT æ¥æ”¶æ™‚ VS | `currentMission.arrival_vitals` |
| è½‰é€é€”ä¸­äº‹ä»¶ | `transitEvents[]` (æœ¬åœ°è¨˜éŒ„ + CIRS addenda) |
| è½‰é€æ‘˜è¦ | `elapsedTime`, `currentMission.oxygen_requirement_lpm` |

### 4.5 é€”ä¸­äº‹ä»¶è¨˜éŒ„ (v3.3 æ–°å¢)

#### 4.5.1 äº‹ä»¶é¡å‹

| é¡å‹ | ä»£ç¢¼ | é¡è‰² | èªªæ˜ |
|------|------|------|------|
| ç”Ÿå‘½å¾µè±¡ | VITALS | ç´… | BP/HR/SpO2/GCS è®ŠåŒ– |
| çµ¦è—¥ | MEDICATION | è— | é€”ä¸­çµ¦è—¥è¨˜éŒ„ |
| O2 èª¿æ•´ | O2_ADJUST | ç¥ç€ | æ°§æ°£æµé‡èª¿æ•´ |
| å‚™è¨» | NOTE | ç° | ä¸€èˆ¬å‚™è¨» |

#### 4.5.2 åŒæ­¥æ©Ÿåˆ¶

```javascript
// è¨˜éŒ„é€”ä¸­äº‹ä»¶ + åŒæ­¥ CIRS
addTransitEvent() {
    // 1. æœ¬åœ°è¨˜éŒ„
    this.transitEvents.push({
        event_type: evt.event_type,
        timestamp: new Date().toISOString(),
        description: description,
        data: { ...evt.data }
    });

    // 2. åŒæ­¥åˆ° CIRS (å¦‚æœæœ‰ç¶²è·¯)
    if (navigator.onLine && this.currentMission?.cirs_handoff_id) {
        fetch(`${this.cirsHubUrl}/api/handoff/${handoffId}/addendum`, {
            method: 'POST',
            body: JSON.stringify({
                addendum_type: 'TRANSIT_EVENT',
                source: 'EMT',
                content: { event_type, description, data }
            })
        });
    }
}
```

### 4.6 çµæ¡ˆé€šçŸ¥ CIRS (v3.3 æ–°å¢)

EMT `finalizeMission()` æˆåŠŸå¾Œï¼Œè‡ªå‹•é€šçŸ¥ CIRS Hub äº¤ç­å®Œæˆï¼š

```javascript
// finalizeMission() æˆåŠŸå¾Œ
if (this.currentMission.cirs_handoff_id && this.cirsHubUrl) {
    await fetch(`${this.cirsHubUrl}/api/handoff/${handoffId}/complete`, {
        method: 'POST',
        body: JSON.stringify({
            completed_by: this.emtCredentials.id,
            completed_by_name: this.emtCredentials.name,
            arrival_notes: `ä»»å‹™å®Œæˆæ–¼ ${timestamp}`,
            destination_confirmed: true
        })
    });
}
```

**CIRS ç«¯æ›´æ–°**:
- `handoff_records.status` â†’ `COMPLETED`
- `registrations.status` â†’ `TRANSFERRED`
- è¨˜éŒ„ `completed_at`, `completed_by`

---

## 5. Step 3: çµæ¡ˆ

### 5.1 çµæ¡ˆ UI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 3/3: çµæ¡ˆ                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€è½‰é€æ‘˜è¦ã€‘                                                 â”‚
â”‚ ç—…æ‚£: ç‹å¤§æ˜ 45M                                            â”‚
â”‚ ç›®çš„åœ°: å¾Œé€é†«é™¢ A                                          â”‚
â”‚ è½‰é€æ™‚é–“: 10:35 ~ 11:02 (27 åˆ†é˜)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€ç‰©è³‡æ¶ˆè€—çµ±è¨ˆã€‘                                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ æ°§æ°£ E ç“¶ #E-042                                        â”‚ â”‚
â”‚ â”‚ åˆå§‹: 1800 PSI â†’ çµæŸ: 1420 PSI                         â”‚ â”‚
â”‚ â”‚ æ¶ˆè€—: 380 PSI (ç´„ 144L)                                 â”‚ â”‚
â”‚ â”‚ çµæŸ PSI: [1420]                              [æ›´æ–°]   â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚ è—¥ç‰©/è€—ææ¶ˆè€—:                                               â”‚
â”‚ [âœ“] TXA 1g Ã— 1 (ä½¿ç”¨ 1ï¼Œæ­¸é‚„ 1)                            â”‚
â”‚ [âœ“] Morphine 10mg Ã— 1 (ä½¿ç”¨ 1ï¼Œæ­¸é‚„ 0)                     â”‚
â”‚ [âœ“] NS 500mL Ã— 1 (ä½¿ç”¨ 1ï¼Œæ­¸é‚„ 1)                          â”‚
â”‚                                                             â”‚
â”‚ è¨­å‚™æ­¸é‚„:                                                    â”‚
â”‚ [âœ“] å¿ƒé›»åœ–ç›£æ¸¬å™¨     é›»é‡: 72%                              â”‚
â”‚ [âœ“] æŠ½å¸æ©Ÿ           é›»é‡: 85%                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ã€çµæ¡ˆå‚™è¨»ã€‘                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ç—…æ‚£é †åˆ©äº¤æ¥è‡³æ€¥è¨ºï¼Œæ„è­˜æ¸…é†’ï¼Œç”Ÿå‘½å¾µè±¡ç©©å®š             â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                             â”‚
â”‚  [è¿”å› Step 2]                      [ç¢ºèªçµæ¡ˆ]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 çµæ¡ˆæµç¨‹

```javascript
async completeMission() {
    // 1. è¨˜éŒ„æœ€çµ‚ PSI
    await this.appendMissionEvent({
        event_type: 'RESOURCE_RETURN',
        resource_type: 'O2_CYLINDER',
        resource_id: this.currentMission.o2_cylinder_id,
        final_psi: this.endingPsi,
        consumed_psi: this.startingPsi - this.endingPsi
    });

    // 2. è¨˜éŒ„ç‰©è³‡æ­¸é‚„
    for (const item of this.resourceSummary) {
        await this.appendMissionEvent({
            event_type: 'RESOURCE_RETURN',
            resource_id: item.id,
            used_qty: item.used,
            returned_qty: item.returned
        });
    }

    // 3. æ›´æ–°ä»»å‹™ç‹€æ…‹
    this.currentMission.status = 'COMPLETED';
    this.currentMission.completed_at = new Date().toISOString();

    // 4. é€šçŸ¥ CIRS äº¤ç­å®Œæˆ
    if (this.currentMission.cirs_handoff_id) {
        await fetch(`${CIRS_HUB_URL}/api/handoff/${this.currentMission.cirs_handoff_id}/complete`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${this.token}`
            },
            body: JSON.stringify({
                completed_at: this.currentMission.completed_at,
                final_notes: this.closingNotes,
                resource_summary: this.resourceSummary
            })
        });
    }

    // 5. å„²å­˜ä¸¦é‡ç½®
    await this.saveMission();
    this.showCompletionSummary();
}
```

---

## 6. è³‡æ–™æ¨¡å‹ (v3.0)

### 6.1 MIRS transfer_missions (ç°¡åŒ–ç‰ˆ)

v3.0 ç§»é™¤é‡è¤‡çš„äº¤ç­æ¬„ä½ï¼Œæ”¹ç‚ºåƒç…§ CIRSï¼š

```sql
CREATE TABLE transfer_missions (
    mission_id TEXT PRIMARY KEY,

    -- CIRS åƒç…§ (å”¯ä¸€çœŸç›¸ä¾†æº)
    cirs_handoff_id TEXT,           -- FK â†’ CIRS handoff_records
    patient_snapshot JSON,          -- æ¥æ”¶æ™‚é–å®šçš„å¿«ç…§å‰¯æœ¬

    -- æœ¬åœ°ä»»å‹™è³‡æ–™
    status TEXT DEFAULT 'PLANNING', -- PLANNING | READY | EN_ROUTE | COMPLETED | CANCELLED
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    started_at TIMESTAMP,
    completed_at TIMESTAMP,

    -- ç‰©è³‡ (é€é events è¿½è¹¤)
    -- é€”ä¸­äº‹ä»¶ (é€é events è¿½è¹¤)

    closing_notes TEXT
);

-- äº‹ä»¶æ—¥èªŒ (Event Sourcing)
CREATE TABLE transfer_mission_events (
    event_id INTEGER PRIMARY KEY AUTOINCREMENT,
    mission_id TEXT NOT NULL,
    event_type TEXT NOT NULL,
    -- RESOURCE_RESERVE | RESOURCE_ISSUE | RESOURCE_RETURN
    -- TRANSIT_EVENT | STATUS_CHANGE
    data JSON,
    recorded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    recorded_by TEXT
);
```

### 6.2 èˆ‡ CIRS handoff_records çš„é—œä¿‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CIRS (Hub)                        MIRS (Satellite)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  handoff_records          â”€â”€â”€â–¶     transfer_missions        â”‚
â”‚    â”œâ”€ handoff_id                     â”œâ”€ mission_id          â”‚
â”‚    â”œâ”€ snapshot (locked)              â”œâ”€ cirs_handoff_id â”€â”€â”€â”€â”¤
â”‚    â”œâ”€ content (ISBAR/MIST)           â”œâ”€ patient_snapshot    â”‚
â”‚    â””â”€ status                         â””â”€ status              â”‚
â”‚                                                             â”‚
â”‚  handoff_addenda          â—€â”€â”€â”€     mission_events           â”‚
â”‚    (ä¾†è‡ª EMT çš„è£œå……)                   (é€”ä¸­äº‹ä»¶)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 7. Alpine.js è³‡æ–™çµæ§‹

### 7.1 ä¸»è¦è³‡æ–™ç‰©ä»¶

```javascript
// EMT PWA: emtTransfer()
return {
    // é€£ç·šç‹€æ…‹
    cirsConnected: false,
    cirsHubUrl: localStorage.getItem('cirs_hub_url') || '',

    // å¾…æ¥æ”¶äº¤ç­åˆ—è¡¨
    pendingHandoffs: [],

    // ç›®å‰ä»»å‹™
    currentMission: null,
    currentStep: 0,  // 0=æ¥æ”¶äº¤ç­, 1=ç‰©è³‡æ•´å‚™, 2=è½‰é€ä¸­, 3=çµæ¡ˆ

    // ç‰©è³‡é¸æ“‡
    selectedO2Cylinder: null,
    selectedEquipment: [],
    selectedMedications: [],

    // é€”ä¸­äº‹ä»¶
    transitEvents: [],

    // çµæ¡ˆè³‡æ–™
    endingPsi: null,
    resourceSummary: [],
    closingNotes: '',

    // æ–¹æ³•
    async init() {
        await this.checkCirsConnection();
        await this.loadPendingHandoffs();
    },

    async loadPendingHandoffs() {
        if (!this.cirsConnected) return;
        const resp = await fetch(`${this.cirsHubUrl}/api/handoff/pending?target_role=EMT`, {
            headers: { 'Authorization': `Bearer ${this.token}` }
        });
        this.pendingHandoffs = await resp.json();
    },

    async acceptHandoff(handoffId) {
        // ... (å¦‚ Section 2.2)
    },

    async addTransitEvent(type, data) {
        // ... (å¦‚ Section 4.2)
    },

    async completeMission() {
        // ... (å¦‚ Section 5.2)
    }
}
```

### 7.2 é¡¯ç¤ºäº¤ç­å…§å®¹ (åªè®€)

```javascript
// å¾ snapshot è§£æé¡¯ç¤º
get patientInfo() {
    const s = this.currentMission?.patient_snapshot;
    if (!s) return null;
    return {
        name: s.person?.name,
        age: s.person?.age,
        gender: s.person?.gender === 'M' ? 'ç”·' : 'å¥³',
        bmi: s.person?.height_cm && s.person?.weight_kg
            ? (s.person.weight_kg / Math.pow(s.person.height_cm/100, 2)).toFixed(1)
            : '-',
        allergies: s.person?.allergies || 'ç„¡'
    };
},

get handoffContent() {
    const c = this.currentMission?.content;
    if (!c) return null;

    // æ ¹æ“š format è§£æ
    if (c.format === 'MIST') {
        return {
            format: 'MIST',
            mechanism: c.mechanism,
            injuries: c.injuries,
            signs: c.signs,
            treatment: c.treatment
        };
    } else {
        return {
            format: 'ISBAR',
            situation: c.situation,
            background: c.background,
            assessment: c.assessment,
            recommendation: c.recommendation
        };
    }
}
```

---

## 8. O2 æµé‡é è¨­å€¼ (å·²å¯¦ä½œ v1.1.0)

### 8.1 æŒ‰éˆ•é…ç½®

```
[ç„¡] [3] [6] [10] [15]
```

### 8.2 å°ç…§è¡¨

| é¸é … | L/min | é©ç”¨æƒ…å¢ƒ |
|------|-------|----------|
| ç„¡ | 0 | ç„¡æ°§æ°£éœ€æ±‚ |
| 3 | 3 | é¼»å°ç®¡ä½æµé‡ |
| 6 | 6 | é¼»å°ç®¡ä¸­æµé‡ |
| 10 | 10 | é¢ç½© / NRB |
| 15 | 15 | NRB é«˜æµé‡ / BVM |

---

## 9. å¯¦ä½œé †åº

### Phase 1: O2 æµé‡å¿«é¸ âœ“ (v1.1.0 å·²å®Œæˆ)

### Phase 2: CIRS çµ±ä¸€äº¤ç­ API (CIRS ç«¯)

> è©³è¦‹ `CIRS/docs/xIRS_UNIFIED_HANDOFF_SPEC_v1.0.md`

| æ­¥é©Ÿ | è®Šæ›´ |
|------|------|
| 2.1 | æ–°å¢ `handoff_records` è¡¨ |
| 2.2 | æ–°å¢ `/api/handoff` API è·¯ç”± |
| 2.3 | Doctor PWA æ•´åˆã€Œå»ºç«‹äº¤ç­ã€ |

### Phase 3: EMT PWA Step é‡æ§‹ (MIRS ç«¯)

| æ­¥é©Ÿ | æª”æ¡ˆ | è®Šæ›´ |
|------|------|------|
| 3.1 | `static/emt/index.html` | Step 0 å¾…æ¥æ”¶äº¤ç­åˆ—è¡¨ |
| 3.2 | `static/emt/index.html` | Step 1 ç‰©è³‡æ•´å‚™ UI |
| 3.3 | `static/emt/index.html` | Step 2 è½‰é€ä¸­ + é€”ä¸­äº‹ä»¶ |
| 3.4 | `static/emt/index.html` | Step 3 çµæ¡ˆ UI |
| 3.5 | `database/` | ç°¡åŒ– transfer_missions schema |
| 3.6 | `routes/transfer.py` | Event sourcing API |

### Phase 4: CIRS/MIRS é›™å‘åŒæ­¥

| æ­¥é©Ÿ | è®Šæ›´ |
|------|------|
| 4.1 | EMT â†’ CIRS: POST addendum (é€”ä¸­äº‹ä»¶) |
| 4.2 | EMT â†’ CIRS: POST complete (çµæ¡ˆé€šçŸ¥) |
| 4.3 | é›¢ç·šä½‡åˆ— + æ¢å¾©åŒæ­¥ |

---

## 10. æ³¨æ„äº‹é …

### 10.1 Snapshot é–å®šåŸå‰‡

- EMT æ¥æ”¶äº¤ç­æ™‚ï¼Œ`snapshot` å³é–å®šï¼Œä¹‹å¾Œä¸éš¨ CIRS æ›´æ–°
- é†«ç™‚æ³•å¾‹è²¬ä»»ä»¥ snapshot ç‰ˆæœ¬ç‚ºæº–
- å¦‚éœ€ä¿®æ”¹ï¼Œé†«å¸«é ˆåœ¨ CIRS å»ºç«‹æ–°ç‰ˆäº¤ç­

### 10.2 é›¢ç·šè™•ç†

- äº¤ç­ snapshot æœ¬åœ°å„²å­˜æ–¼ IndexedDB
- é€”ä¸­äº‹ä»¶å…ˆå¯«æœ¬åœ°ï¼Œæ¢å¾©é€£ç·šå¾Œ sync
- ç‰©è³‡æ“ä½œå³æ™‚è¨˜éŒ„ï¼Œä¸ä¾è³´ç¶²è·¯

### 10.3 éš±ç§ä¿è­·

- ç—…æ‚£è³‡æ–™åªåœ¨ä»»å‹™æœŸé–“ä¿å­˜
- çµæ¡ˆå¾Œä¿ç•™çµ±è¨ˆæ‘˜è¦ï¼Œæ¸…é™¤è©³ç´°ç—…æ­·
- ç¬¦åˆ HIPAA/GDPR è¦æ±‚

---

## é™„éŒ„ A: ISBAR/MIST æ ¼å¼åƒè€ƒ

### A.1 ISBAR æ ¼å¼ (ä¸€èˆ¬/å…§ç§‘)

| æ¬„ä½ | è‹±æ–‡ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|------|
| **I** | Identify | èº«ä»½è¾¨è­˜ | ç‹å°æ˜ï¼Œ45æ­²ï¼Œç”·æ€§ |
| **S** | Situation | ç¾æ³èªªæ˜ | èƒ¸ç—› 2 å°æ™‚ï¼Œéœ€è½‰é€å¿ƒå°ç®¡å®¤ |
| **B** | Background | ç—…å²èƒŒæ™¯ | HTN, DM, éæ•: Penicillin |
| **A** | Assessment | è©•ä¼°ç‹€æ³ | BP 150/90, HR 88, SpO2 98% |
| **R** | Recommendation | å»ºè­°äº‹é … | ç›£æ¸¬å¿ƒé›»åœ–ï¼Œæº–å‚™ NTG |

### A.2 MIST æ ¼å¼ (å¤–å‚·)

| æ¬„ä½ | è‹±æ–‡ | èªªæ˜ | ç¯„ä¾‹ |
|------|------|------|------|
| **M** | Mechanism | å—å‚·æ©Ÿè½‰ | æ©Ÿè»Šå°æ’ï¼Œæ™‚é€Ÿç´„ 60 |
| **I** | Injuries | å‚·å‹¢ç™¼ç¾ | å³è‚¡éª¨é–‹æ”¾æ€§éª¨æŠ˜ï¼Œå³èƒ¸æŒ«å‚· |
| **S** | Signs | ç”Ÿå‘½å¾µè±¡ | GCS 15, BP 110/70, HR 100 |
| **T** | Treatment | å·²è™•ç½® | æ­¢è¡€å¸¶ã€å¤¾æ¿å›ºå®šã€TXA 1g |

---

**De Novo Orthopedics Inc. / è°·ç›ºç”Ÿç‰©ç§‘æŠ€è‚¡ä»½æœ‰é™å…¬å¸**

*æ–‡ä»¶ç‰ˆæœ¬: v3.0*
*æ›´æ–°æ—¥æœŸ: 2026-01-05*
