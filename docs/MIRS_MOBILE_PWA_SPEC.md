# MIRS Mobile PWA é–‹ç™¼è¦æ ¼æ›¸ v0.1

> å·¡æˆ¿åŠ©æ‰‹ï¼šé†«è­·äººå“¡çš„è¡Œå‹•ç‰©è³‡ç®¡ç†å·¥å…·

**ç‹€æ…‹**: Draft
**æ—¥æœŸ**: 2025-12-18
**åƒè€ƒ**: CIRS Satellite PWA v1.3.1

---

## 1. ç”¢å“å®šä½

### 1.1 èˆ‡ CIRS Satellite çš„å·®ç•°

| é …ç›® | CIRS Satellite | MIRS Mobile |
|------|---------------|-------------|
| **å®šä½** | å‚³ä»¤å…µ | å·¡æˆ¿åŠ©æ‰‹ |
| **ç”¨æˆ¶** | å¿—å·¥ï¼ˆå¯èƒ½ç„¡é†«ç™‚èƒŒæ™¯ï¼‰ | é†«è­·äººå“¡ï¼ˆè­·ç†å¸«ã€é†«å¸«ï¼‰ |
| **ç’°å¢ƒ** | æ”¶å®¹æ‰€ï¼ˆ50-500äººï¼‰ | é†«ç™‚ç«™ï¼ˆ1-50ç—…æ‚£ï¼‰ |
| **ä¸»è¦æ“ä½œ** | å ±åˆ°ã€ç™¼æ”¾ç‰©è³‡ | è¨­å‚™å·¡æª¢ã€è—¥å“ç™¼æ”¾ã€åº«å­˜æŸ¥è©¢ |
| **ç§»å‹•ç¯„åœ** | å¤§ï¼ˆé–€å£ã€ç™¼æ”¾å€ã€ä¼‘æ¯å€ï¼‰ | ä¸­ï¼ˆç—…åºŠã€è—¥å±€ã€è¨­å‚™å€ï¼‰ |
| **å°ˆæ¥­åº¦** | ä½ï¼ˆç°¡åŒ–æ“ä½œï¼‰ | ä¸­ï¼ˆå…è¨±å°ˆæ¥­è¡“èªï¼‰ |
| **é›¢ç·šé »ç‡** | é«˜ï¼ˆç½å€ç¶²è·¯ä¸ç©©ï¼‰ | ä¸­ï¼ˆé›¢å³¶/åé åœ°å€ï¼‰ |

### 1.2 æ ¸å¿ƒåƒ¹å€¼

1. **è¨­å‚™å·¡æª¢è¡Œå‹•åŒ–** - èµ°åˆ°å“ªæª¢æŸ¥åˆ°å“ªï¼Œä¸ç”¨å›è­·ç†ç«™ç™»è¨˜
2. **ç·Šæ€¥ç™¼è—¥ç„¡å»¶é²** - ç—…åºŠé‚Šç›´æ¥æˆæ¬Šç™¼è—¥
3. **éŸŒæ€§å³æ™‚ç›£æ§** - æ°§æ°£ã€é›»åŠ›å‰©é¤˜æ™‚æ•¸ä¸€ç›®äº†ç„¶
4. **é›¢ç·šä¸ä¸­æ–·** - ç¶²è·¯æ–·ç·šä»å¯æ“ä½œï¼Œæ¢å¾©å¾Œè‡ªå‹•åŒæ­¥

### 1.3 è¨­è¨ˆåŸå‰‡

1. **ä¸€éµå®Œæˆ** - æ¯å€‹æ“ä½œæœ€å¤š 3 æ­¥
2. **éŒ¯èª¤å®¹å¿** - æŒ‰éŒ¯å¯æ’¤éŠ·ï¼Œé›¢ç·šå¯é‡è©¦
3. **å°ˆæ¥­å‹å–„** - ä½¿ç”¨é†«ç™‚ç¸®å¯«ï¼ˆPRN, CBCï¼‰ï¼Œä½†æœ‰è§£é‡‹
4. **éŸŒæ€§å„ªå…ˆ** - é›»åŠ›/æ°§æ°£ç‹€æ…‹æ°¸é åœ¨é¦–é å¯è¦‹

---

## 2. ç³»çµ±æ¶æ§‹

### 2.1 Hub & Spoke æ¶æ§‹ï¼ˆæ²¿ç”¨ CIRS æ¨¡å¼ï¼‰

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     Raspberry Pi (Hub)          â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚ CIRS:8090 â”‚ MIRS:8000     â”‚  â”‚
                    â”‚  â”‚ ç¤¾å€ç‰©è³‡   â”‚ é†«ç™‚åº«å­˜      â”‚  â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â”‚         SQLite Database         â”‚
                    â”‚       (Single Source of Truth)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚ WiFi / LAN
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚               â”‚               â”‚
              â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
              â”‚ MIRS Web  â”‚   â”‚ MIRS      â”‚   â”‚ MIRS      â”‚
              â”‚ Dashboard â”‚   â”‚ Mobile    â”‚   â”‚ Mobile    â”‚
              â”‚           â”‚   â”‚ (è­·ç†å¸«A)  â”‚   â”‚ (é†«å¸«B)    â”‚
              â”‚ ğŸ–¥ï¸ é›»è…¦   â”‚   â”‚ ğŸ“± æ‰‹æ©Ÿ    â”‚   â”‚ ğŸ“± å¹³æ¿    â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 ç®¡ç†ä¸­å¿ƒ        ç—…æˆ¿å·¡æª¢        æ€¥è¨ºå€
```

### 2.2 è³‡æ–™æµ

```
Satellite PWA (æ‰‹æ©Ÿ)          Hub (MIRS Backend)           Web Dashboard
      â”‚                              â”‚                           â”‚
      â”‚  POST /api/mobile/check      â”‚                           â”‚
      â”‚  { equipment_id, status }    â”‚                           â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                           â”‚
      â”‚                              â”‚  Update equipment table   â”‚
      â”‚                              â”‚  Broadcast via WebSocket  â”‚
      â”‚                              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
      â”‚                              â”‚                           â”‚  Dashboard
      â”‚  200 OK                      â”‚                           â”‚  auto-refresh
      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                           â”‚
```

### 2.3 æŠ€è¡“é¸å‹

| å±¤ç´š | æŠ€è¡“ | ç†ç”± |
|------|------|------|
| **å‰ç«¯** | Alpine.js + Tailwind CSS | èˆ‡ CIRS Satellite ä¸€è‡´ï¼Œå­¸ç¿’æ›²ç·šä½ |
| **PWA** | Service Worker + IndexedDB | é›¢ç·šæ”¯æ´ |
| **èªè­‰** | 6 ä½æ•¸é…å°ç¢¼ + JWT | æ²¿ç”¨ CIRS æˆç†Ÿæ–¹æ¡ˆ |
| **é€šè¨Š** | REST API | ç°¡å–®å¯é ï¼Œé›¢ç·šå‹å–„ |
| **å¾Œç«¯** | FastAPI (å·²æœ‰) | æ–°å¢ `/api/mobile/*` ç«¯é» |

---

## 3. åŠŸèƒ½è¦æ ¼

### 3.1 åŠŸèƒ½å„ªå…ˆç´š

| åŠŸèƒ½ | å„ªå…ˆç´š | èªªæ˜ |
|------|--------|------|
| é…å°èˆ‡èªè­‰ | P0 | æ²¿ç”¨ CIRS 6 ä½æ•¸é…å°ç¢¼ |
| éŸŒæ€§å„€è¡¨æ¿ | P0 | æ°§æ°£/é›»åŠ›å‰©é¤˜æ™‚æ•¸é¦–é é¡¯ç¤º |
| è¨­å‚™å¿«é€Ÿæª¢æŸ¥ | P0 | ä¸€éµæ›´æ–°è¨­å‚™ç‹€æ…‹ |
| åº«å­˜æŸ¥è©¢ | P1 | å”¯è®€æŸ¥çœ‹è—¥å“/è€—æåº«å­˜ |
| ç·Šæ€¥ç™¼è—¥ | P1 | Break-the-Glass ç·Šæ€¥ç™¼è—¥ |
| æ°§æ°£ç“¶ç‹€æ…‹ | P1 | å€‹åˆ¥ç“¶ä½ % æ›´æ–° |
| æ­£å¸¸ç™¼è—¥ | P2 | éœ€ PIN ç¢¼å¯©æ ¸ |
| è¡€è¢‹é ˜ç”¨ | P2 | è¨˜éŒ„ç—…æ‚£+è¡€å‹ |
| æ‰‹è¡“è€—æ | P3 | æ‰‹è¡“ä¸­å³æ™‚è¨˜éŒ„è€—æ |

### 3.2 é¦–é ï¼šéŸŒæ€§ç‹€æ…‹ç¸½è¦½

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¥ MIRS Mobile                     â”‚
â”‚  è˜­å¶¼è¡›ç”Ÿæ‰€ (TC-01)         âš™ï¸ è¨­å®š  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â±ï¸ å­¤ç«‹å¤©æ•¸è¨­å®š: 5å¤©               â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ« æ°§æ°£      â”‚ â”‚ âš¡ é›»åŠ›      â”‚   â”‚
â”‚  â”‚             â”‚ â”‚             â”‚   â”‚
â”‚  â”‚   11.5 hr   â”‚ â”‚   60 hr     â”‚   â”‚
â”‚  â”‚   ğŸ”´ CRITICALâ”‚ â”‚   ğŸŸ¡ WARNING â”‚   â”‚
â”‚  â”‚             â”‚ â”‚             â”‚   â”‚
â”‚  â”‚  [è©³ç´° >]   â”‚ â”‚  [è©³ç´° >]   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“‹ å¿«é€Ÿæ“ä½œ                        â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ”§    â”‚ â”‚  ğŸ’Š    â”‚ â”‚  ğŸ“¦    â”‚  â”‚
â”‚  â”‚ è¨­å‚™   â”‚ â”‚ ç™¼è—¥   â”‚ â”‚ åº«å­˜   â”‚  â”‚
â”‚  â”‚ å·¡æª¢   â”‚ â”‚        â”‚ â”‚ æŸ¥è©¢   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“¡ é€£ç·šç‹€æ…‹: âœ… å·²é€£ç·š              â”‚
â”‚  ğŸ”„ æœ€å¾ŒåŒæ­¥: 14:30:25              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.3 è¨­å‚™å·¡æª¢

#### æµç¨‹

```
è¨­å‚™åˆ—è¡¨ â†’ é¸æ“‡è¨­å‚™ â†’ æ›´æ–°ç‹€æ…‹ â†’ ç¢ºèª â†’ è‡ªå‹•åŒæ­¥
```

#### ä»‹é¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”§ è¨­å‚™å·¡æª¢                   [è¿”å›] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ ç¯©é¸: [å…¨éƒ¨â–¾] [å¾…æª¢æŸ¥å„ªå…ˆâœ“]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ âš ï¸ è¡Œå‹•é›»æºç«™ (UTIL-001)        â”‚â”‚
â”‚  â”‚    ç‹€æ…‹: å¾…æª¢æŸ¥                 â”‚â”‚
â”‚  â”‚    é›»é‡: --                     â”‚â”‚
â”‚  â”‚                    [æª¢æŸ¥ >]     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ âœ… Hå‹æ°§æ°£ç“¶ #1 (RESP-001-A)    â”‚â”‚
â”‚  â”‚    ç‹€æ…‹: æ­£å¸¸                   â”‚â”‚
â”‚  â”‚    å……å¡«: 95%                    â”‚â”‚
â”‚  â”‚    æª¢æŸ¥: ä»Šæ—¥ 09:15            â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ğŸŸ¡ æ°§æ°£æ¿ƒç¸®æ©Ÿ (RESP-002)        â”‚â”‚
â”‚  â”‚    ç‹€æ…‹: è­¦å‘Š                   â”‚â”‚
â”‚  â”‚    å‚™è¨»: æ¿¾ç¶²éœ€æ›´æ›             â”‚â”‚
â”‚  â”‚                    [æª¢æŸ¥ >]     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æª¢æŸ¥è¡¨å–®

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”§ è¨­å‚™æª¢æŸ¥                         â”‚
â”‚  Hå‹æ°§æ°£ç“¶ #1 (RESP-001-A)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  ç‹€æ…‹:                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”       â”‚
â”‚  â”‚ âœ… â”‚ â”‚ âš ï¸ â”‚ â”‚ âŒ â”‚ â”‚ ğŸ”§ â”‚       â”‚
â”‚  â”‚æ­£å¸¸â”‚ â”‚è­¦å‘Šâ”‚ â”‚æ•…éšœâ”‚ â”‚ç¶­ä¿®â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜       â”‚
â”‚                                     â”‚
â”‚  å……å¡«ç™¾åˆ†æ¯”: [  95  ] %             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â—â”€â”€â”€â”€              â”‚
â”‚                                     â”‚
â”‚  å‚™è¨» (é¸å¡«):                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚                                 â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                     â”‚
â”‚         [ ç¢ºèªæª¢æŸ¥ ]                 â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.4 è—¥å“ç™¼æ”¾

#### ç·Šæ€¥ç™¼è—¥ (Break-the-Glass)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸš¨ ç·Šæ€¥ç™¼è—¥                   [è¿”å›] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  âš ï¸ ç·Šæ€¥æ¨¡å¼ï¼šè·³éè—¥å¸«å¯©æ ¸          â”‚
â”‚     æ“ä½œå°‡è¢«è¨˜éŒ„ä¾›äº‹å¾Œç¨½æ ¸          â”‚
â”‚                                     â”‚
â”‚  è—¥å“: [æœå°‹æˆ–é¸æ“‡è—¥å“...]          â”‚
â”‚                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Morphine 10mg/mL (MED-003)     â”‚â”‚
â”‚  â”‚ åº«å­˜: 15 æ”¯                     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                     â”‚
â”‚  æ•¸é‡: [ 2 ]  æ”¯                    â”‚
â”‚        [-]  [+]                     â”‚
â”‚                                     â”‚
â”‚  é ˜è—¥äºº: [è­·ç†å¸« A â–¾]               â”‚
â”‚                                     â”‚
â”‚  ç·Šæ€¥åŸå› : (å¿…å¡«)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ å¤§é‡å‚·æ‚£æ¹§å…¥ï¼Œéœ€ç«‹å³æ­¢ç—›        â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                     â”‚
â”‚      [ ğŸš¨ ç¢ºèªç·Šæ€¥ç™¼è—¥ ]            â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.5 åº«å­˜æŸ¥è©¢

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“¦ åº«å­˜æŸ¥è©¢                   [è¿”å›] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ” [æœå°‹è—¥å“/è€—æ...]              â”‚
â”‚  ç¯©é¸: [å…¨éƒ¨â–¾] [ä½åº«å­˜âš ï¸]           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚  ğŸ’Š è—¥å“                            â”‚
â”‚  â”œâ”€ Morphine 10mg     15æ”¯    ğŸŸ¡   â”‚
â”‚  â”œâ”€ Paracetamol 500mg 200é¡†   ğŸŸ¢   â”‚
â”‚  â”œâ”€ Amoxicillin 500mg 80é¡†    ğŸŸ¢   â”‚
â”‚  â””â”€ Insulin Regular   5ç“¶     ğŸŸ¡   â”‚
â”‚                                     â”‚
â”‚  ğŸ©¹ è€—æ                            â”‚
â”‚  â”œâ”€ ç´—å¸ƒ 4x4         150ç‰‡   ğŸŸ¢   â”‚
â”‚  â”œâ”€ IV Set           25çµ„    ğŸŸ¡   â”‚
â”‚  â””â”€ å°å°¿ç®¡ #16       10æ ¹    ğŸ”´   â”‚
â”‚                                     â”‚
â”‚  ğŸ©¸ è¡€åº«                            â”‚
â”‚  â”œâ”€ A+               3è¢‹     ğŸŸ¡   â”‚
â”‚  â”œâ”€ O-               5è¢‹     ğŸŸ¢   â”‚
â”‚  â””â”€ B+               0è¢‹     ğŸ”´   â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. API è¦æ ¼

### 4.1 èªè­‰ APIï¼ˆæ²¿ç”¨ CIRSï¼‰

```http
# ç”¢ç”Ÿé…å°ç¢¼ï¼ˆHub ç«¯ï¼‰
POST /api/auth/mobile-pairing
Authorization: Bearer {admin_token}
Content-Type: application/json

{
  "allowed_roles": "nurse,doctor",  // å¯é¸
  "expires_minutes": 5              // é è¨­ 5 åˆ†é˜
}

Response:
{
  "code": "384756",
  "expires_at": "2025-12-18T15:35:00Z",
  "allowed_roles": "nurse,doctor"
}
```

```http
# äº¤æ›é…å°ç¢¼ï¼ˆMobile ç«¯ï¼‰
POST /api/auth/mobile/exchange
Content-Type: application/json

{
  "pairing_code": "384756",
  "device_id": "uuid-xxxx-xxxx",
  "device_name": "iPhone è­·ç†å¸«A"  // é¸å¡«
}

Response:
{
  "access_token": "eyJhbG...",
  "expires_in": 43200,  // 12 å°æ™‚
  "station_id": "TC-01",
  "station_name": "è˜­å¶¼è¡›ç”Ÿæ‰€",
  "user_role": "nurse"
}
```

### 4.2 éŸŒæ€§ API

```http
# å–å¾—éŸŒæ€§ç‹€æ…‹
GET /api/mobile/resilience
Authorization: Bearer {token}

Response:
{
  "station_id": "TC-01",
  "isolation_target_hours": 120,
  "lifelines": {
    "oxygen": {
      "total_liters": 13800,
      "burn_rate_lpm": 20,
      "hours_remaining": 11.5,
      "status": "CRITICAL",
      "profile": "2ä½æ’ç®¡æ‚£è€…"
    },
    "power": {
      "total_liters": 180,
      "burn_rate_lph": 3.0,
      "hours_remaining": 60,
      "status": "WARNING",
      "profile": "æ¨™æº–é‹ä½œ"
    }
  },
  "overall_status": "CRITICAL",
  "weakest_link": "oxygen"
}
```

### 4.3 è¨­å‚™ API

```http
# å–å¾—è¨­å‚™åˆ—è¡¨
GET /api/mobile/equipment?filter=pending  // pending=å¾…æª¢æŸ¥
Authorization: Bearer {token}

Response:
{
  "equipment": [
    {
      "id": "UTIL-001",
      "name": "è¡Œå‹•é›»æºç«™",
      "category": "power",
      "status": "pending",
      "power_level": null,
      "last_check": null
    },
    {
      "id": "RESP-001-A",
      "name": "Hå‹æ°§æ°£ç“¶ #1",
      "category": "oxygen",
      "status": "normal",
      "power_level": 95,
      "last_check": "2025-12-18T09:15:00Z"
    }
  ],
  "pending_count": 3,
  "total_count": 12
}
```

```http
# æ›´æ–°è¨­å‚™ç‹€æ…‹
POST /api/mobile/equipment/{equipment_id}/check
Authorization: Bearer {token}
Content-Type: application/json

{
  "status": "normal",       // normal, warning, fault, maintenance
  "power_level": 95,        // 0-100, å¯é¸
  "notes": "æ¿¾ç¶²å·²æ›´æ›"      // å¯é¸
}

Response:
{
  "success": true,
  "equipment_id": "RESP-001-A",
  "checked_at": "2025-12-18T14:30:00Z",
  "checked_by": "è­·ç†å¸«A"
}
```

### 4.4 ç™¼è—¥ API

```http
# ç·Šæ€¥ç™¼è—¥
POST /api/mobile/dispense/emergency
Authorization: Bearer {token}
Content-Type: application/json

{
  "item_code": "MED-003",
  "quantity": 2,
  "dispenser": "è­·ç†å¸«A",
  "emergency_reason": "å¤§é‡å‚·æ‚£æ¹§å…¥"
}

Response:
{
  "success": true,
  "dispense_id": "DISP-2025-1218-001",
  "item_name": "Morphine 10mg/mL",
  "quantity": 2,
  "remaining_stock": 13,
  "audit_note": "ç·Šæ€¥ç™¼è—¥ï¼Œå¾…è—¥å¸«ç¢ºèª"
}
```

### 4.5 åº«å­˜ API

```http
# æŸ¥è©¢åº«å­˜
GET /api/mobile/inventory?type=medication&low_stock=true
Authorization: Bearer {token}

Response:
{
  "items": [
    {
      "code": "MED-001",
      "name": "Paracetamol 500mg",
      "category": "medication",
      "quantity": 200,
      "unit": "é¡†",
      "min_stock": 50,
      "status": "normal"
    }
  ],
  "low_stock_count": 3,
  "total_count": 45
}
```

---

## 5. é›¢ç·šç­–ç•¥

### 5.1 é›¢ç·šå¯ç”¨åŠŸèƒ½

| åŠŸèƒ½ | é›¢ç·šæ”¯æ´ | åŒæ­¥ç­–ç•¥ |
|------|----------|----------|
| éŸŒæ€§å„€è¡¨æ¿ | âœ… é¡¯ç¤ºå¿«å–è³‡æ–™ | æ¯æ¬¡é€£ç·šåˆ·æ–° |
| è¨­å‚™æª¢æŸ¥ | âœ… æš«å­˜æ“ä½œ | é€£ç·šå¾Œä¾åºä¸Šå‚³ |
| ç·Šæ€¥ç™¼è—¥ | âœ… æš«å­˜æ“ä½œ | é€£ç·šå¾Œä¾åºä¸Šå‚³ |
| åº«å­˜æŸ¥è©¢ | âœ… é¡¯ç¤ºå¿«å–è³‡æ–™ | æ¯æ¬¡é€£ç·šåˆ·æ–° |
| æ­£å¸¸ç™¼è—¥ | âŒ éœ€ç·šä¸Šå¯©æ ¸ | - |

### 5.2 Action Envelope Patternï¼ˆæ²¿ç”¨ CIRSï¼‰

```javascript
// é›¢ç·šæ“ä½œæš«å­˜æ ¼å¼
{
  "action_id": "uuid-xxxx",           // å†ªç­‰æ€§ä¿è­‰
  "action_type": "equipment_check",
  "payload": {
    "equipment_id": "RESP-001-A",
    "status": "normal",
    "power_level": 95
  },
  "device_id": "device-uuid",
  "created_at": "2025-12-18T14:30:00Z",
  "synced": false,
  "retry_count": 0
}
```

### 5.3 åŒæ­¥æµç¨‹

```
PWA å•Ÿå‹•
    â”‚
    â”œâ”€ æª¢æŸ¥ç¶²è·¯ç‹€æ…‹
    â”‚
    â”œâ”€ å¦‚æœç·šä¸Š:
    â”‚   â”œâ”€ ä¸Šå‚³æ‰€æœ‰ pending actions
    â”‚   â”œâ”€ åˆ·æ–°éŸŒæ€§/åº«å­˜å¿«å–
    â”‚   â””â”€ æ›´æ–° lastSyncTime
    â”‚
    â””â”€ å¦‚æœé›¢ç·š:
        â”œâ”€ è¼‰å…¥å¿«å–è³‡æ–™
        â””â”€ é¡¯ç¤ºé›¢ç·šæŒ‡ç¤ºå™¨
```

---

## 6. å¯¦ä½œéšæ®µ

### Phase 1: æ ¸å¿ƒåŠŸèƒ½ (MVP)

**ç›®æ¨™**: å¯ç”¨æ–¼ç¾å ´æ¸¬è©¦çš„æœ€å°ç‰ˆæœ¬

**ç¯„åœ**:
- [ ] é…å°èªè­‰ï¼ˆæ²¿ç”¨ CIRS æ¨¡å¼ï¼‰
- [ ] éŸŒæ€§å„€è¡¨æ¿é¦–é 
- [ ] è¨­å‚™å¿«é€Ÿæª¢æŸ¥
- [ ] é›¢ç·šæš«å­˜ + è‡ªå‹•åŒæ­¥

**é ä¼°å·¥æ™‚**: 2-3 å¤©

### Phase 2: è—¥å“åŠŸèƒ½

**ç›®æ¨™**: æ”¯æ´è—¥å“ç™¼æ”¾æµç¨‹

**ç¯„åœ**:
- [ ] ç·Šæ€¥ç™¼è—¥
- [ ] åº«å­˜æŸ¥è©¢
- [ ] æ­£å¸¸ç™¼è—¥ï¼ˆéœ€ PINï¼‰

**é ä¼°å·¥æ™‚**: 2-3 å¤©

### Phase 3: é€²éšåŠŸèƒ½

**ç›®æ¨™**: å®Œæ•´é†«ç™‚ç«™è¡Œå‹•æ”¯æ´

**ç¯„åœ**:
- [ ] æ°§æ°£ç“¶å€‹åˆ¥è¿½è¹¤
- [ ] è¡€è¢‹é ˜ç”¨
- [ ] æ‰‹è¡“è€—æè¨˜éŒ„
- [ ] WebSocket å³æ™‚æ›´æ–°

**é ä¼°å·¥æ™‚**: 3-5 å¤©

---

## 7. å®‰å…¨è€ƒé‡

### 7.1 èªè­‰

- 6 ä½æ•¸é…å°ç¢¼ï¼Œ5 åˆ†é˜æœ‰æ•ˆ
- API Rate Limiting: 5 æ¬¡/åˆ†é˜/IP
- JWT Token: 12 å°æ™‚æœ‰æ•ˆï¼Œå¯æ‰‹å‹•ç™»å‡º
- Device ID ç¶å®šï¼Œé˜²æ­¢ Token è¤‡è£½

### 7.2 è³‡æ–™ä¿è­·

- é›¢ç·šè³‡æ–™åƒ…å­˜æ–¼ IndexedDBï¼Œä¸å«æ•æ„Ÿå€‹è³‡
- è—¥å“ç™¼æ”¾è¨˜éŒ„åŒ…å«æ“ä½œè€… IDï¼Œä¾›äº‹å¾Œç¨½æ ¸
- ç·Šæ€¥ç™¼è—¥å¿…é ˆå¡«å¯«åŸå› 

### 7.3 æ¬Šé™æ§åˆ¶

| è§’è‰² | è¨­å‚™æª¢æŸ¥ | åº«å­˜æŸ¥è©¢ | ç·Šæ€¥ç™¼è—¥ | æ­£å¸¸ç™¼è—¥ |
|------|----------|----------|----------|----------|
| nurse | âœ… | âœ… | âœ… | âœ… (éœ€PIN) |
| doctor | âœ… | âœ… | âœ… | âœ… |
| admin | âœ… | âœ… | âœ… | âœ… |
| readonly | âŒ | âœ… | âŒ | âŒ |

---

## 8. èˆ‡ CIRS Satellite çš„ç¨‹å¼ç¢¼å…±ç”¨

### 8.1 å¯å…±ç”¨æ¨¡çµ„

```
/shared/
â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ pairing-code-flow.js   # 6 ä½æ•¸é…å°ç¢¼é‚è¼¯
â”‚   â””â”€â”€ jwt-storage.js         # Token ç®¡ç†
â”œâ”€â”€ sync/
â”‚   â”œâ”€â”€ action-envelope.js     # é›¢ç·šæ“ä½œæš«å­˜
â”‚   â”œâ”€â”€ sync-manager.js        # åŒæ­¥æ’ç¨‹
â”‚   â””â”€â”€ network-status.js      # é€£ç·šç‹€æ…‹åµæ¸¬
â””â”€â”€ ui/
    â”œâ”€â”€ loading-screen.js      # CDN è¼‰å…¥åµæ¸¬
    â””â”€â”€ offline-indicator.js   # é›¢ç·šæç¤º
```

### 8.2 MIRS å°ˆç”¨æ¨¡çµ„

```
/mirs-mobile/
â”œâ”€â”€ pages/
â”‚   â”œâ”€â”€ resilience-dashboard.js  # éŸŒæ€§é¦–é 
â”‚   â”œâ”€â”€ equipment-check.js       # è¨­å‚™æª¢æŸ¥
â”‚   â”œâ”€â”€ dispense-emergency.js    # ç·Šæ€¥ç™¼è—¥
â”‚   â””â”€â”€ inventory-query.js       # åº«å­˜æŸ¥è©¢
â””â”€â”€ services/
    â”œâ”€â”€ resilience-api.js        # éŸŒæ€§ API
    â””â”€â”€ equipment-api.js         # è¨­å‚™ API
```

---

## 9. æ¸¬è©¦è¨ˆç•«

### 9.1 åŠŸèƒ½æ¸¬è©¦

- [ ] é…å°æµç¨‹ï¼ˆæ­£å¸¸ / éæœŸ / éŒ¯èª¤ç¢¼ï¼‰
- [ ] è¨­å‚™æª¢æŸ¥æµç¨‹ï¼ˆç·šä¸Š / é›¢ç·šï¼‰
- [ ] ç·Šæ€¥ç™¼è—¥æµç¨‹
- [ ] é›¢ç·šâ†’ç·šä¸ŠåŒæ­¥

### 9.2 è£ç½®æ¸¬è©¦

- [ ] iPhone Safari (iOS 15+)
- [ ] Android Chrome (Android 8+)
- [ ] iPad Safari
- [ ] Android å¹³æ¿

### 9.3 ç¶²è·¯æ¸¬è©¦

- [ ] WiFi ç©©å®š
- [ ] WiFi ä¸ç©©ï¼ˆæ–·æ–·çºŒçºŒï¼‰
- [ ] å®Œå…¨é›¢ç·š â†’ æ¢å¾©
- [ ] ä½é »å¯¬ç’°å¢ƒ

---

## 10. æœªä¾†æ“´å±•

### 10.1 v1.0 ä¹‹å¾Œè€ƒæ…®

1. **é€šçŸ¥æ¨æ’­** - ä½åº«å­˜/è¨­å‚™ç•°å¸¸ä¸»å‹•é€šçŸ¥
2. **èªéŸ³è¼¸å…¥** - æˆ´æ‰‹å¥—æ™‚èªéŸ³æ“ä½œ
3. **NFC æ”¯æ´** - æƒæè¨­å‚™ NFC Tag
4. **å¤šç«™åŒæ­¥** - è·¨ç«™é»èª¿æ’¥æ”¯æ´

### 10.2 èˆ‡ CIRS æ•´åˆ

- é†«ç™‚ç‰©è³‡å¾ MIRS èª¿æ’¥è‡³ CIRS æ”¶å®¹æ‰€
- å…±ç”¨ xIRS å®‰å…¨è³‡æ–™äº¤æ›å”è­°
- çµ±ä¸€çš„éŸŒæ€§ä¼°ç®—æ¡†æ¶

---

## é™„éŒ„ A: ç¾æœ‰ MIRS API ç›¤é»

éœ€è¦æ–°å¢æˆ–ä¿®æ”¹çš„ APIï¼š

| ç«¯é» | ç‹€æ…‹ | èªªæ˜ |
|------|------|------|
| `/api/auth/mobile-pairing` | ğŸ†• æ–°å¢ | ç”¢ç”Ÿé…å°ç¢¼ |
| `/api/auth/mobile/exchange` | ğŸ†• æ–°å¢ | äº¤æ› Token |
| `/api/mobile/resilience` | ğŸ†• æ–°å¢ | éŸŒæ€§ç‹€æ…‹ |
| `/api/mobile/equipment` | ğŸ†• æ–°å¢ | è¨­å‚™åˆ—è¡¨ |
| `/api/mobile/equipment/{id}/check` | ğŸ†• æ–°å¢ | æ›´æ–°ç‹€æ…‹ |
| `/api/mobile/dispense/emergency` | ğŸ“ ä¿®æ”¹ | åŠ å…¥ Mobile æ”¯æ´ |
| `/api/mobile/inventory` | ğŸ†• æ–°å¢ | ç°¡åŒ–åº«å­˜æŸ¥è©¢ |
| `/api/equipment` | âœ… ç¾æœ‰ | å¯èƒ½éœ€åŠ æ¬„ä½ |
| `/api/dispense/emergency` | âœ… ç¾æœ‰ | å¯å…±ç”¨é‚è¼¯ |

---

## é™„éŒ„ B: è¨­è¨ˆç¨¿é€£çµ

ï¼ˆå¾…è£œå…… Figma / æˆªåœ–ï¼‰

---

*Document Version: 0.1*
*Created: 2025-12-18*
*Author: De Novo Orthopedics Inc.*
