# BioMed PWA é–‹ç™¼è¦æ ¼æ›¸ v1.1

**ç‰ˆæœ¬**: 1.1.3
**æ—¥æœŸ**: 2026-01-11
**ç‹€æ…‹**: Production Ready

---

## æ¦‚è¿°

BioMed PWA æ˜¯ MIRS ç³»çµ±çš„è¨­å‚™ç¶­è­·æ¨¡çµ„ï¼Œæä¾›è¼•é‡ç´šçš„è¨­å‚™ç®¡ç†ä»‹é¢ï¼Œå°ˆç‚ºç¾å ´äººå“¡è¨­è¨ˆã€‚

---

## ç‰ˆæœ¬æ­·å²

| ç‰ˆæœ¬ | æ—¥æœŸ | è®Šæ›´ |
|------|------|------|
| v1.0.0 | 2026-01-09 | åˆç‰ˆï¼šè¨­å‚™ç®¡ç† + éŸŒæ€§ä¼°ç®— |
| v1.1.0 | 2026-01-10 | MIRS é¢¨æ ¼ Tab å°èˆªé‡æ§‹ |
| v1.1.1 | 2026-01-11 | ä¿®å¾©ç¢ºèªæŒ‰éˆ• + éŸŒæ€§è³‡æºæ¸…å–® |
| v1.1.2 | 2026-01-11 | å–®ä½ç®¡ç†åŠŸèƒ½ + Alpine.js ç›¸å®¹æ€§ä¿®å¾© |
| v1.1.3 | 2026-01-11 | API è·¯å¾‘ä¿®æ­£ + equipment é…è‰² + Vercel å–®ä½ mock |

---

## æ¶æ§‹

### æª”æ¡ˆçµæ§‹

```
frontend/biomed/
â”œâ”€â”€ index.html          # ä¸»é é¢ (Alpine.js SPA)
â”œâ”€â”€ manifest.json       # PWA manifest
â”œâ”€â”€ service-worker.js   # SW v1.1.2
â””â”€â”€ icons/
    â”œâ”€â”€ icon-192.png
    â””â”€â”€ icon-512.png
```

### æŠ€è¡“å †ç–Š

- **å‰ç«¯æ¡†æ¶**: Alpine.js (CDN â†’ æœ¬åœ°åŒ–)
- **CSS**: Tailwind CSS (æœ¬åœ°åŒ–)
- **é›¢ç·šæ”¯æ´**: Service Worker (Network-first + cache fallback)

---

## åŠŸèƒ½æ¨¡çµ„

### 1. è¨­å‚™ç®¡ç† Tab

#### è¨­å‚™åˆ†é¡é¡¯ç¤º

| å€å¡Š | æ¢ä»¶ | é¡è‰² |
|------|------|------|
| ä¾›é›»è¨­å‚™ | `resilience_category='POWER'` æˆ–åç¨±å«ç™¼é›»æ©Ÿ/é›»æ± /UPS | equipment-900 (æ·±) |
| è€—é›»è¨­å‚™ | `power_consumption > 0` æˆ– `resilience_category='OXYGEN'` | equipment-700 |
| å…¶ä»–è¨­å‚™ | ä¸å±¬æ–¼ä¸Šè¿°å…©é¡ | equipment-600 |

#### è¨­å‚™æ“ä½œæŒ‰éˆ•

| æŒ‰éˆ• | åœ–ç¤º | åŠŸèƒ½ | API |
|------|------|------|-----|
| ç¢ºèª | âœ“ | æ¨™è¨˜è¨­å‚™å·²æª¢æŸ¥ | `POST /api/equipment/check/{id}` |
| ç®¡ç†å–®ä½ | âŠ | é–‹å•Ÿå–®ä½ç®¡ç† Modal | `GET /v2/equipment/{id}/units` |
| ç·¨è¼¯ | âœ | é–‹å•Ÿç·¨è¼¯ Modal | - |
| åˆªé™¤ | âœ• | åˆªé™¤è¨­å‚™ | `DELETE /api/equipment/{id}` |

### 2. å–®ä½ç®¡ç†åŠŸèƒ½ (v1.1.2)

#### UI å…ƒä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å–®ä½ç®¡ç† - {è¨­å‚™åç¨±}        [X]    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å¿«é€Ÿæ•¸é‡èª¿æ•´                         â”‚
â”‚ [âˆ’]  [ 5 ]  [+]  [å¥—ç”¨]             â”‚
â”‚ ç›®å‰: 5 å€‹å–®ä½ â†’ 6                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç¾æœ‰å–®ä½ (5)                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ GEN-001  100%  [AVAILABLE] [ğŸ—‘]â”‚ â”‚
â”‚ â”‚ GEN-002   85%  [IN_USE]    [ğŸ—‘]â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ç§»é™¤åŸå› ï¼ˆå¯é¸ï¼‰                     â”‚
â”‚ [________________________]          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ–°å¢å–®ä½                             â”‚
â”‚ é›»é‡% [100] ç‹€æ…‹ [AVAILABLEâ–¼] [+æ–°å¢]â”‚
â”‚ æ–°å¢åŸå›  [________________________] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â–¶ å·²ç§»é™¤å–®ä½ (2)                     â”‚
â”‚   GEN-003 (å·²ç§»é™¤: è¨­å‚™æ•…éšœ) [æ¢å¾©]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                            [é—œé–‰]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### API ç«¯é»

| ç«¯é» | æ–¹æ³• | åŠŸèƒ½ |
|------|------|------|
| `/v2/equipment/{id}/units` | GET | å–å¾—å–®ä½åˆ—è¡¨ (å« inactive) |
| `/v2/equipment/{id}/units` | POST | æ–°å¢å–®ä½ |
| `/v2/equipment/units/{id}` | DELETE | è»Ÿåˆªé™¤å–®ä½ |
| `/v2/equipment/units/{id}/restore` | POST | æ¢å¾©å–®ä½ |
| `/v2/equipment/{id}/quantity` | PUT | æ‰¹æ¬¡èª¿æ•´æ•¸é‡ |

#### å–®ä½ç‹€æ…‹

| ç‹€æ…‹ | é¡è‰² | èªªæ˜ |
|------|------|------|
| AVAILABLE | green | å¯ç”¨ |
| IN_USE | blue | ä½¿ç”¨ä¸­ |
| CHARGING | yellow | å……é›»ä¸­ |
| MAINTENANCE | gray | ç¶­è­·ä¸­ |
| EMPTY | red | é›»é‡è€—ç›¡ |

### 3. éŸŒæ€§ä¼°ç®— Tab

#### è³‡æ–™ä¾†æº

```javascript
// API Response çµæ§‹
{
  "summary": { "overall_status": "WARNING" },
  "lifelines": [
    {
      "type": "OXYGEN",
      "name": "æ°§æ°£ä¾›æ‡‰",
      "endurance": { "hours": 36.5, "days": 1.52 },
      "resources": [
        { "name": "Hå‹æ°§æ°£é‹¼ç“¶", "quantity": 5, "fill_pct": 80 }
      ]
    }
  ]
}
```

#### UI é¡¯ç¤º

- **æ•´é«”éŸŒæ€§æ™‚æ•¸**: é¡¯ç¤ºæœ€å¼±ç”Ÿå‘½ç·š
- **æ°§æ°£å¡ç‰‡**: æ™‚æ•¸ + é€²åº¦æ¢ + è³‡æºæ¸…å–®
- **é›»åŠ›å¡ç‰‡**: æ™‚æ•¸ + é€²åº¦æ¢ + è³‡æºæ¸…å–®

#### Alpine.js ç›¸å®¹æ€§ä¿®å¾© (v1.1.2)

```javascript
// éŒ¯èª¤ (æŸäº› Alpine ç‰ˆæœ¬ä¸æ”¯æ´)
x-show="resilienceStatus.oxygenResources?.length > 0"

// æ­£ç¢º
x-show="resilienceStatus.oxygenResources && resilienceStatus.oxygenResources.length > 0"
```

---

## Vercel Demo æ¨¡å¼

ç•¶ `IS_VERCEL=1` æ™‚ï¼ŒAPI è¿”å›æ¨¡æ“¬è³‡æ–™ï¼š

### /api/equipment

è¿”å› 5 å€‹æ¨¡æ“¬è¨­å‚™ï¼ˆç™¼é›»æ©Ÿã€æ°§æ°£ç“¶ç­‰ï¼‰

### /api/resilience/status

```python
return {
    "lifelines": [
        {
            "type": "OXYGEN",
            "resources": [
                {"name": "Hå‹æ°§æ°£é‹¼ç“¶", "quantity": 5, "capacity_L": 6800, "fill_pct": 80},
                {"name": "Eå‹æ°§æ°£ç“¶", "quantity": 4, "capacity_L": 680, "fill_pct": 65}
            ]
        },
        {
            "type": "POWER",
            "resources": [
                {"name": "ç™¼é›»æ©Ÿ", "fuel_L": 50, "fuel_pct": 70},
                {"name": "è¡Œå‹•é›»æºç«™", "quantity": 2, "charge_pct": 85}
            ]
        }
    ]
}
```

---

## Service Worker

### å¿«å–ç­–ç•¥

- **éœæ…‹è³‡æº**: Network-first, cache fallback
- **API è«‹æ±‚**: ä¸å¿«å– (ç›´æ¥èµ°ç¶²è·¯)

### ç‰ˆæœ¬ç®¡ç†

```javascript
const CACHE_NAME = 'mirs-biomed-v1.1.2';
```

æ›´æ–° Service Worker ç‰ˆæœ¬è™Ÿæœƒè§¸ç™¼èˆŠå¿«å–æ¸…é™¤ã€‚

---

## æ¸¬è©¦æ¸…å–®

### Vercel ç’°å¢ƒ

- [x] è¨­å‚™åˆ—è¡¨è¼‰å…¥
- [x] ç¢ºèªæŒ‰éˆ• (âœ“) æ­£å¸¸é‹ä½œ
- [x] éŸŒæ€§ä¼°ç®— Tab é¡¯ç¤ºæ°§æ°£/é›»åŠ›è³‡æº
- [x] å–®ä½ç®¡ç† Modal é–‹å•Ÿ
- [ ] å–®ä½ CRUD (éœ€å¾Œç«¯æ”¯æ´)

### RPi ç’°å¢ƒ

- [ ] è¨­å‚™åˆ—è¡¨å¾æœ¬åœ° DB è¼‰å…¥
- [ ] ç¢ºèªæŒ‰éˆ•æ›´æ–°è³‡æ–™åº«
- [ ] å–®ä½ç®¡ç†å®Œæ•´ CRUD
- [ ] éŸŒæ€§ä¼°ç®—å³æ™‚è¨ˆç®—
- [ ] é›¢ç·šæ¨¡å¼é‹ä½œ

---

## å¾…è¾¦äº‹é …

1. **Vercel Demo å–®ä½ API**: ç›®å‰ `/v2/equipment/{id}/units` åœ¨ Vercel æœƒ 404
2. **è¨­å‚™é¡åˆ¥é¸æ“‡**: æ–°å¢è¨­å‚™æ™‚çš„é¡åˆ¥ä¸‹æ‹‰é¸å–®
3. **æ‰¹æ¬¡ç¢ºèª**: ä¸€éµç¢ºèªæ‰€æœ‰è¨­å‚™

---

**æ–‡ä»¶ç‰ˆæœ¬**: v1.1
**æ’°å¯«è€…**: Claude Code
**æ—¥æœŸ**: 2026-01-11
